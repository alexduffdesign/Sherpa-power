class a{constructor(e){if(!e.container)throw new Error("ChatbotUI requires a container element");if(!e.eventBus)throw new Error("ChatbotUI requires an event bus");this.container=e.container,this.eventBus=e.eventBus,this.type=e.type,this.setupUIElements(),this.setupEventListeners()}setupUIElements(){var i;const e=this.container.querySelectorAll(".message-container");this.messageContainer=e[0],console.log("Message container found:",!!this.messageContainer);const t=this.container.querySelectorAll(".chat-form");this.form=t[0],console.log("Chat form found:",!!this.form);const n=this.container.querySelectorAll(".chatbot-input");this.input=n[0],console.log("Chat input found:",!!this.input);const s=this.container.querySelectorAll(".chat-typing");if(this.typingIndicator=s[0],console.log("Typing indicator found:",!!this.typingIndicator),this.typingText=(i=this.typingIndicator)==null?void 0:i.querySelector(".typing-text"),console.log("Typing text found:",!!this.typingText),console.log("Container HTML:",this.container.innerHTML),!this.messageContainer||!this.form||!this.input){const o=[];throw this.messageContainer||o.push("message-container"),this.form||o.push("chat-form"),this.input||o.push("chatbot-input"),new Error(`Required UI elements not found: ${o.join(", ")}`)}}setupEventListeners(){this.form.addEventListener("submit",e=>{e.preventDefault();const t=this.input.value.trim();t&&(this.eventBus.emit("userMessage",t),this.input.value="")}),this.eventBus.on("messageReceived",({content:e,metadata:t})=>{console.log("UI received messageReceived event:",e,t),this.addMessage("assistant",e,t)}),this.eventBus.on("typing",({isTyping:e})=>{e?this.showTypingIndicator():this.hideTypingIndicator()}),this.eventBus.on("error",({message:e})=>{this.displayError(e)}),this.eventBus.on("choicePresented",({buttons:e})=>{this.addButtons(e)}),this.eventBus.on("carouselPresented",({items:e})=>{this.addCarousel(e)})}addMessage(e,t,n=null){console.log(`addMessage called with sender=${e}, content=${t}, metadata=`,n);const s=document.createElement("message-component");s.eventBus=this.eventBus,s.setAttribute("sender",e),s.setAttribute("content",t),n&&s.setAttribute("metadata",JSON.stringify(n)),this.messageContainer.appendChild(s),this.scrollToBottom()}addButtons(e){if(!Array.isArray(e)){console.error("Invalid buttons data:",e);return}const t=document.createElement("div");t.className="button-group",e.forEach(n=>{const s=document.createElement("button-component");s.eventBus=this.eventBus,s.setAttribute("label",n.name),s.setAttribute("payload",JSON.stringify(n.request)),t.appendChild(s)}),this.messageContainer.appendChild(t),this.scrollToBottom()}addCarousel(e){if(!Array.isArray(e)){console.error("Invalid carousel items:",e);return}const t=document.createElement("carousel-component");t.eventBus=this.eventBus,t.setAttribute("data-carousel",JSON.stringify({cards:e})),this.messageContainer.appendChild(t),this.scrollToBottom()}showTypingIndicator(){this.typingIndicator&&(this.typingIndicator.style.display="flex",this.scrollToBottom())}hideTypingIndicator(){this.typingIndicator&&(this.typingIndicator.style.display="none")}displayError(e){const t=document.createElement("div");t.classList.add("error-message"),t.textContent=e,this.messageContainer.appendChild(t),this.scrollToBottom()}removeInteractiveElements(){this.messageContainer.querySelectorAll("button-component, carousel-component, .button-group").forEach(t=>t.remove())}scrollToBottom(){this.messageContainer.scrollTop=this.messageContainer.scrollHeight}destroy(){this.eventBus.removeAllListeners()}}export{a as C};
//# sourceMappingURL=base-chatbot-ui.BzGndWVX.js.map
