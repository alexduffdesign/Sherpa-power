{"version":3,"file":"chatbot-drawer-Crps1WO0.js","sources":["../frontend/entrypoints/chatbot-drawer.js"],"sourcesContent":["import { Drawer } from \"./theme.js\";\nimport MainChatbot from \"./chatbot-main.js\";\n\nconsole.log(\"Chatbot drawer script loaded\");\n\nfunction initChatbotDrawer(drawerId) {\n  class MainChatbotElement extends HTMLElement {\n    constructor() {\n      super();\n      this.mainChatbot = null;\n    }\n\n    connectedCallback() {\n      if (!this.mainChatbot) {\n        console.log(\"MainChatbotElement connected\");\n        const config = {\n          voiceflowEndpoint:\n            \"https://chatbottings--development.gadget.app/voiceflow\",\n        };\n        this.mainChatbot = new MainChatbot(this, config);\n      }\n    }\n\n    async initializeNewChat() {\n      console.log(\"MainChatbotElement initializeNewChat called\");\n      if (this.mainChatbot) {\n        await this.mainChatbot.initializeNewChat();\n      } else {\n        console.error(\n          \"MainChatbot not initialized when trying to initialize new chat\"\n        );\n      }\n    }\n  }\n\n  class ChatbotDrawer extends Drawer {\n    constructor() {\n      super();\n      this.mainChatbotElement = null;\n      this.initialized = false;\n      console.log(\"ChatbotDrawer constructor called\");\n    }\n\n    connectedCallback() {\n      super.connectedCallback();\n      console.log(\"ChatbotDrawer connectedCallback called\");\n      this.mainChatbotElement = this.querySelector(\"main-chatbot\");\n      if (this.mainChatbotElement) {\n        console.log(\"MainChatbotElement found in ChatbotDrawer\");\n      } else {\n        console.error(\"MainChatbotElement not found in ChatbotDrawer\");\n      }\n    }\n\n    async show() {\n      super.show();\n      console.log(\"ChatbotDrawer show method called\");\n      if (this.mainChatbotElement) {\n        console.log(\"MainChatbotElement exists in show method\");\n        const hasLaunched = localStorage.getItem(\"chatHasLaunched\") === \"true\";\n        console.log(\"hasLaunched:\", hasLaunched);\n        if (!hasLaunched) {\n          console.log(\"Initializing new chat for the first time\");\n          if (this.mainChatbotElement.mainChatbot) {\n            console.log(\"mainChatbot exists, calling initializeNewChat\");\n            await this.mainChatbotElement.mainChatbot.initializeNewChat();\n            this.initialized = true;\n            localStorage.setItem(\"chatHasLaunched\", \"true\");\n            console.log(\"Chat initialized and localStorage updated\");\n          } else {\n            console.error(\"mainChatbot does not exist on MainChatbotElement\");\n          }\n        } else if (!this.initialized) {\n          console.log(\"Loading previous conversation\");\n          if (this.mainChatbotElement.mainChatbot) {\n            this.mainChatbotElement.mainChatbot.loadConversationFromStorage();\n            this.mainChatbotElement.mainChatbot.displaySavedConversation();\n            this.initialized = true;\n            console.log(\"Previous conversation loaded and displayed\");\n          } else {\n            console.error(\"mainChatbot does not exist on MainChatbotElement\");\n          }\n        } else {\n          console.log(\"Chat already initialized\");\n        }\n      } else {\n        console.error(\n          \"MainChatbotElement not found when trying to show drawer\"\n        );\n      }\n    }\n  }\n\n  customElements.define(\"main-chatbot\", MainChatbotElement);\n  customElements.define(\"chatbot-drawer\", ChatbotDrawer);\n\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    const chatbotDrawer = document.getElementById(drawerId);\n    const chatbotTrigger = document.querySelector(\n      `button[aria-controls=\"${drawerId}\"]`\n    );\n    if (chatbotDrawer && chatbotTrigger) {\n      chatbotTrigger.addEventListener(\"click\", async () => {\n        await chatbotDrawer.show();\n      });\n    } else {\n      console.error(\"Chatbot drawer or trigger not found\");\n    }\n  });\n\n  document.addEventListener(\"dialog:after-show\", (event) => {\n    if (event.target.id === drawerId) {\n      console.log(\"Chatbot drawer opened\");\n    }\n  });\n\n  document.addEventListener(\"dialog:after-hide\", (event) => {\n    if (event.target.id === drawerId) {\n      console.log(\"Chatbot drawer closed\");\n    }\n  });\n}\n\nwindow.initChatbotDrawer = initChatbotDrawer;\n\nif (window.chatbotDrawerId) {\n  initChatbotDrawer(window.chatbotDrawerId);\n}\n"],"names":["initChatbotDrawer","drawerId","MainChatbotElement","config","MainChatbot","ChatbotDrawer","Drawer","hasLaunched","chatbotDrawer","chatbotTrigger","event"],"mappings":"iOAGA,QAAQ,IAAI,8BAA8B,EAE1C,SAASA,EAAkBC,EAAU,CACnC,MAAMC,UAA2B,WAAY,CAC3C,aAAc,CACZ,QACA,KAAK,YAAc,IACpB,CAED,mBAAoB,CAClB,GAAI,CAAC,KAAK,YAAa,CACrB,QAAQ,IAAI,8BAA8B,EAC1C,MAAMC,EAAS,CACb,kBACE,wDACZ,EACQ,KAAK,YAAc,IAAIC,EAAY,KAAMD,CAAM,CAChD,CACF,CAED,MAAM,mBAAoB,CACxB,QAAQ,IAAI,6CAA6C,EACrD,KAAK,YACP,MAAM,KAAK,YAAY,oBAEvB,QAAQ,MACN,gEACV,CAEK,CACF,CAED,MAAME,UAAsBC,CAAO,CACjC,aAAc,CACZ,QACA,KAAK,mBAAqB,KAC1B,KAAK,YAAc,GACnB,QAAQ,IAAI,kCAAkC,CAC/C,CAED,mBAAoB,CAClB,MAAM,kBAAiB,EACvB,QAAQ,IAAI,wCAAwC,EACpD,KAAK,mBAAqB,KAAK,cAAc,cAAc,EACvD,KAAK,mBACP,QAAQ,IAAI,2CAA2C,EAEvD,QAAQ,MAAM,+CAA+C,CAEhE,CAED,MAAM,MAAO,CAGX,GAFA,MAAM,KAAI,EACV,QAAQ,IAAI,kCAAkC,EAC1C,KAAK,mBAAoB,CAC3B,QAAQ,IAAI,0CAA0C,EACtD,MAAMC,EAAc,aAAa,QAAQ,iBAAiB,IAAM,OAChE,QAAQ,IAAI,eAAgBA,CAAW,EAClCA,EAWO,KAAK,YAWf,QAAQ,IAAI,0BAA0B,GAVtC,QAAQ,IAAI,+BAA+B,EACvC,KAAK,mBAAmB,aAC1B,KAAK,mBAAmB,YAAY,8BACpC,KAAK,mBAAmB,YAAY,2BACpC,KAAK,YAAc,GACnB,QAAQ,IAAI,4CAA4C,GAExD,QAAQ,MAAM,kDAAkD,IAlBlE,QAAQ,IAAI,0CAA0C,EAClD,KAAK,mBAAmB,aAC1B,QAAQ,IAAI,+CAA+C,EAC3D,MAAM,KAAK,mBAAmB,YAAY,kBAAiB,EAC3D,KAAK,YAAc,GACnB,aAAa,QAAQ,kBAAmB,MAAM,EAC9C,QAAQ,IAAI,2CAA2C,GAEvD,QAAQ,MAAM,kDAAkD,EAe5E,MACQ,QAAQ,MACN,yDACV,CAEK,CACF,CAED,eAAe,OAAO,eAAgBL,CAAkB,EACxD,eAAe,OAAO,iBAAkBG,CAAa,EAErD,SAAS,iBAAiB,mBAAoB,IAAM,CAClD,MAAMG,EAAgB,SAAS,eAAeP,CAAQ,EAChDQ,EAAiB,SAAS,cAC9B,yBAAyBR,CAAQ,IACvC,EACQO,GAAiBC,EACnBA,EAAe,iBAAiB,QAAS,SAAY,CACnD,MAAMD,EAAc,MAC5B,CAAO,EAED,QAAQ,MAAM,qCAAqC,CAEzD,CAAG,EAED,SAAS,iBAAiB,oBAAsBE,GAAU,CACpDA,EAAM,OAAO,KAAOT,GACtB,QAAQ,IAAI,uBAAuB,CAEzC,CAAG,EAED,SAAS,iBAAiB,oBAAsBS,GAAU,CACpDA,EAAM,OAAO,KAAOT,GACtB,QAAQ,IAAI,uBAAuB,CAEzC,CAAG,CACH,CAEA,OAAO,kBAAoBD,EAEvB,OAAO,iBACTA,EAAkB,OAAO,eAAe"}