{"version":3,"file":"base-chatbot-ui.DxQT9tG6.js","sources":["../frontend/baseChatbot/base-chatbot-ui.js"],"sourcesContent":["// /assets/scripts/chatbot/core/chatbot-ui.js\n\n/**\n * ChatbotUI Class\n * Handles base UI functionality for chatbots\n */\nclass ChatbotUI {\n  /**\n   * @param {Object} config - Configuration object\n   * @param {HTMLElement} config.container - The container element for the chatbot\n   * @param {EventEmitter} config.eventBus - Event bus instance\n   * @param {string} config.type - Type of chatbot ('main' or 'section')\n   */\n  constructor(config) {\n    if (!config.container) {\n      throw new Error(\"ChatbotUI requires a container element\");\n    }\n    if (!config.eventBus) {\n      throw new Error(\"ChatbotUI requires an event bus\");\n    }\n\n    this.container = config.container;\n    this.eventBus = config.eventBus;\n    this.type = config.type;\n\n    this.setupUIElements();\n    this.setupEventListeners();\n  }\n\n  /**\n   * Set up references to UI elements\n   * @private\n   */\n  setupUIElements() {\n    this.messageContainer = this.container.querySelector(\".message-container\");\n    this.form = this.container.querySelector(\".chat-form\");\n    this.input = this.container.querySelector(\".chatbot-input\");\n    this.typingIndicator = this.container.querySelector(\".chat-typing\");\n    this.typingText = this.typingIndicator?.querySelector(\".typing-text\");\n\n    if (!this.messageContainer || !this.form || !this.input) {\n      throw new Error(\"Required UI elements not found\");\n    }\n  }\n\n  /**\n   * Set up event listeners for UI interactions\n   * @private\n   */\n  setupEventListeners() {\n    // Handle form submissions\n    this.form.addEventListener(\"submit\", (e) => {\n      e.preventDefault();\n      const message = this.input.value.trim();\n      if (message) {\n        this.eventBus.emit(\"userMessage\", message);\n        this.input.value = \"\";\n      }\n    });\n\n    // Listen for chatbot events\n    this.eventBus.on(\"messageReceived\", ({ content, metadata }) => {\n      this.addMessage(\"assistant\", content, metadata);\n    });\n\n    this.eventBus.on(\"typing\", ({ isTyping }) => {\n      if (isTyping) {\n        this.showTypingIndicator();\n      } else {\n        this.hideTypingIndicator();\n      }\n    });\n\n    this.eventBus.on(\"error\", ({ message }) => {\n      this.displayError(message);\n    });\n\n    this.eventBus.on(\"choicePresented\", ({ buttons }) => {\n      this.addButtons(buttons);\n    });\n\n    this.eventBus.on(\"carouselPresented\", ({ items }) => {\n      this.addCarousel(items);\n    });\n  }\n\n  /**\n   * Add a message to the chat\n   * @public\n   * @param {string} sender - The sender of the message ('user' or 'assistant')\n   * @param {string} content - The message content\n   * @param {Object} metadata - Optional metadata for the message\n   */\n  addMessage(sender, content, metadata = null) {\n    const message = document.createElement(\"message-component\");\n    message.setAttribute(\"sender\", sender);\n    message.setAttribute(\"content\", content);\n\n    if (metadata) {\n      message.setAttribute(\"metadata\", JSON.stringify(metadata));\n    }\n\n    this.messageContainer.appendChild(message);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Add interactive buttons to the chat\n   * @public\n   * @param {Array} buttons - Array of button data\n   */\n  addButtons(buttons) {\n    if (!Array.isArray(buttons)) {\n      console.error(\"Invalid buttons data:\", buttons);\n      return;\n    }\n\n    const buttonGroup = document.createElement(\"div\");\n    buttonGroup.className = \"button-group\";\n\n    buttons.forEach((buttonData) => {\n      const button = document.createElement(\"button-component\");\n      button.setAttribute(\"label\", buttonData.name);\n      button.setAttribute(\"payload\", JSON.stringify(buttonData.request));\n      buttonGroup.appendChild(button);\n    });\n\n    this.messageContainer.appendChild(buttonGroup);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Add a carousel to the chat\n   * @public\n   * @param {Array} items - Array of carousel items\n   */\n  addCarousel(items) {\n    if (!Array.isArray(items)) {\n      console.error(\"Invalid carousel items:\", items);\n      return;\n    }\n\n    const carousel = document.createElement(\"carousel-component\");\n    carousel.setAttribute(\"data-carousel\", JSON.stringify({ cards: items }));\n    this.messageContainer.appendChild(carousel);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Show the typing indicator\n   * @public\n   */\n  showTypingIndicator() {\n    if (this.typingIndicator) {\n      this.typingIndicator.style.display = \"flex\";\n      this.scrollToBottom();\n    }\n  }\n\n  /**\n   * Hide the typing indicator\n   * @public\n   */\n  hideTypingIndicator() {\n    if (this.typingIndicator) {\n      this.typingIndicator.style.display = \"none\";\n    }\n  }\n\n  /**\n   * Display an error message\n   * @public\n   * @param {string} message - The error message to display\n   */\n  displayError(message) {\n    const errorDiv = document.createElement(\"div\");\n    errorDiv.classList.add(\"error-message\");\n    errorDiv.textContent = message;\n    this.messageContainer.appendChild(errorDiv);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Remove all interactive elements\n   * @public\n   */\n  removeInteractiveElements() {\n    const elements = this.messageContainer.querySelectorAll(\n      \"button-component, carousel-component, .button-group\"\n    );\n    elements.forEach((element) => element.remove());\n  }\n\n  /**\n   * Scroll the message container to the bottom\n   * @private\n   */\n  scrollToBottom() {\n    this.messageContainer.scrollTop = this.messageContainer.scrollHeight;\n  }\n\n  /**\n   * Clean up resources\n   * @public\n   */\n  destroy() {\n    this.eventBus.removeAllListeners();\n  }\n}\n\nexport default ChatbotUI;\n"],"names":["ChatbotUI","config","_a","e","message","content","metadata","isTyping","buttons","items","sender","buttonGroup","buttonData","button","carousel","errorDiv","element"],"mappings":"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"}