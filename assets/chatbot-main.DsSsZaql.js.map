{"version":3,"file":"chatbot-main.DsSsZaql.js","sources":["../frontend/entrypoints/chatbot-main.js"],"sourcesContent":["// /assets/scripts/chatbot/main/chatbot-main.js\n\nimport ChatbotCore from \"../core/chatbot-core.js\";\nimport MainChatbotUI from \"../ui/chatbot-main-ui.js\";\nimport eventBus from \"../utils/event-bus.js\";\nimport { generateUserId } from \"../utils/user-id-generator.js\";\n\nclass MainChatbot {\n  constructor() {\n    this.userID = generateUserId(\"mainChatbot\");\n    this.endpoint =\n      \"https://chatbottings--development.gadget.app/voiceflowAPI/voiceflow-streaming\";\n\n    this.ui = new MainChatbotUI(document.getElementById(\"main-chatbot-ui\"));\n    this.core = new ChatbotCore({\n      userID: this.userID,\n      endpoint: this.endpoint,\n      chatbotType: \"main\",\n    });\n\n    this.setupEventListeners();\n  }\n\n  /**\n   * Sets up event listeners for various chatbot events.\n   */\n  setupEventListeners() {\n    // Listen for chatbot launch event\n    document.addEventListener(\"chatbotLaunch\", () => {\n      console.log(\"chatbotLaunch event received\");\n      this.core.sendLaunch();\n    });\n\n    // Listen for messages from the user\n    this.ui.onUserMessage((message) => {\n      this.core.sendMessage(message);\n    });\n\n    // Listen for choices presented by the chatbot\n    eventBus.on(\"mainChatbot:choicePresented\", ({ buttons }) => {\n      console.log(\"Received choices:\", buttons);\n      this.ui.addButtons(buttons);\n    });\n\n    // Listen for messages received from the chatbot\n    eventBus.on(\"mainChatbot:messageReceived\", ({ content }) => {\n      this.ui.addMessage(\"assistant\", content);\n    });\n\n    // Listen for carousels presented by the chatbot\n    eventBus.on(\"mainChatbot:carouselPresented\", ({ carouselItems }) => {\n      this.ui.addCarousel(carouselItems);\n    });\n\n    // Listen for carousel button clicks\n    eventBus.on(\"carouselButtonClicked\", async (payload) => {\n      try {\n        // Send the button payload to the chatbot core\n        await this.core.sendAction({\n          action: payload,\n          config: {},\n        });\n      } catch (error) {\n        console.error(\"Error handling carousel button click:\", error);\n      }\n    });\n\n    // Listen for typing indicators\n    eventBus.on(\"mainChatbot:typing\", ({ isTyping }) => {\n      if (isTyping) {\n        this.ui.showTypingIndicator();\n      } else {\n        this.ui.hideTypingIndicator();\n      }\n    });\n\n    // Listen for errors\n    eventBus.on(\"mainChatbot:error\", ({ message }) => {\n      this.ui.displayError(message);\n    });\n  }\n\n  /**\n   * Launches the chatbot by sending the launch action.\n   */\n  launch() {\n    if (this.isLaunched) return;\n    console.log(\"Launching chatbot\");\n    this.core.sendLaunch();\n    this.isLaunched = true;\n  }\n\n  /**\n   * Destroys the chatbot instance, cleaning up resources.\n   */\n  destroy() {\n    this.core.destroy();\n  }\n}\n\nexport default MainChatbot;\n"],"names":["MainChatbot","generateUserId","MainChatbotUI","ChatbotCore","message","eventBus","buttons","content","carouselItems","payload","error","isTyping"],"mappings":"oIAOA,MAAMA,CAAY,CAChB,aAAc,CACZ,KAAK,OAASC,EAAe,aAAa,EAC1C,KAAK,SACH,gFAEF,KAAK,GAAK,IAAIC,EAAc,SAAS,eAAe,iBAAiB,CAAC,EACtE,KAAK,KAAO,IAAIC,EAAY,CAC1B,OAAQ,KAAK,OACb,SAAU,KAAK,SACf,YAAa,MACnB,CAAK,EAED,KAAK,oBAAmB,CACzB,CAKD,qBAAsB,CAEpB,SAAS,iBAAiB,gBAAiB,IAAM,CAC/C,QAAQ,IAAI,8BAA8B,EAC1C,KAAK,KAAK,YAChB,CAAK,EAGD,KAAK,GAAG,cAAeC,GAAY,CACjC,KAAK,KAAK,YAAYA,CAAO,CACnC,CAAK,EAGDC,EAAS,GAAG,8BAA+B,CAAC,CAAE,QAAAC,CAAO,IAAO,CAC1D,QAAQ,IAAI,oBAAqBA,CAAO,EACxC,KAAK,GAAG,WAAWA,CAAO,CAChC,CAAK,EAGDD,EAAS,GAAG,8BAA+B,CAAC,CAAE,QAAAE,CAAO,IAAO,CAC1D,KAAK,GAAG,WAAW,YAAaA,CAAO,CAC7C,CAAK,EAGDF,EAAS,GAAG,gCAAiC,CAAC,CAAE,cAAAG,CAAa,IAAO,CAClE,KAAK,GAAG,YAAYA,CAAa,CACvC,CAAK,EAGDH,EAAS,GAAG,wBAAyB,MAAOI,GAAY,CACtD,GAAI,CAEF,MAAM,KAAK,KAAK,WAAW,CACzB,OAAQA,EACR,OAAQ,CAAE,CACpB,CAAS,CACF,OAAQC,EAAO,CACd,QAAQ,MAAM,wCAAyCA,CAAK,CAC7D,CACP,CAAK,EAGDL,EAAS,GAAG,qBAAsB,CAAC,CAAE,SAAAM,CAAQ,IAAO,CAC9CA,EACF,KAAK,GAAG,sBAER,KAAK,GAAG,qBAEhB,CAAK,EAGDN,EAAS,GAAG,oBAAqB,CAAC,CAAE,QAAAD,CAAO,IAAO,CAChD,KAAK,GAAG,aAAaA,CAAO,CAClC,CAAK,CACF,CAKD,QAAS,CACH,KAAK,aACT,QAAQ,IAAI,mBAAmB,EAC/B,KAAK,KAAK,aACV,KAAK,WAAa,GACnB,CAKD,SAAU,CACR,KAAK,KAAK,SACX,CACH"}