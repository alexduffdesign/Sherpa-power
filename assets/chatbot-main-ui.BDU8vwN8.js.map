{"version":3,"file":"chatbot-main-ui.BDU8vwN8.js","sources":["../frontend/mainChatbot/chatbot-main-ui.js"],"sourcesContent":["// /assets/scripts/chatbot/main/main-chatbot-ui.js\n\nimport eventBus from \"../utils/event-bus.js\";\nimport { MAIN_CHATBOT } from \"../utils/event-constants.js\";\nimport { BaseChatbotUI } from \"../baseChatbot/base-chatbot-ui.js\";\n\n/**\n * MainChatbotUI Class\n * Extends BaseChatbotUI with drawer-specific functionality\n */\nexport class MainChatbotUI extends BaseChatbotUI {\n  /**\n   * @param {ShadowRoot} shadowRoot - The shadow root of the chatbot component\n   * @param {EventEmitter} eventBus - The event bus for this chatbot instance\n   */\n  constructor(shadowRoot, eventBus) {\n    super(shadowRoot, eventBus);\n    this.setupMainChatbotUI();\n  }\n\n  /**\n   * Set up main chatbot specific UI elements and functionality\n   * @private\n   */\n  setupMainChatbotUI() {\n    // Set up footer elements\n    this.footer = this.shadowRoot.querySelector(\".chatbot-footer\");\n    this.setupFooterEventListeners();\n  }\n\n  /**\n   * Set up event listeners specific to the main chatbot\n   * @protected\n   * @override\n   */\n  setupEventListeners() {\n    super.setupEventListeners();\n\n    // Handle button clicks with main chatbot namespace\n    this.messageContainer.addEventListener(\"click\", (e) => {\n      const button = e.target.closest(\"button-component\");\n      if (button) {\n        const payload = JSON.parse(button.getAttribute(\"payload\"));\n        const label = button.getAttribute(\"label\");\n\n        this.eventBus.emit(MAIN_CHATBOT.BUTTON_CLICK, {\n          ...payload,\n          label,\n          type: \"choice\",\n        });\n\n        // Add the button text as a user message\n        this.addMessage(\"user\", label);\n        this.removeInteractiveElements();\n      }\n    });\n\n    // Handle carousel button clicks with main chatbot namespace\n    this.messageContainer.addEventListener(\"click\", (e) => {\n      const carouselButton = e.target.closest(\"carousel-button\");\n      if (carouselButton) {\n        const payload = JSON.parse(carouselButton.getAttribute(\"payload\"));\n        const label = carouselButton.getAttribute(\"label\");\n\n        this.eventBus.emit(MAIN_CHATBOT.CAROUSEL_BUTTON_CLICK, {\n          ...payload,\n          label,\n          type: \"carousel_click\",\n        });\n\n        // Add the button text as a user message\n        this.addMessage(\"user\", label);\n      }\n    });\n  }\n\n  /**\n   * Add buttons to the chat\n   * @param {Array} buttons - Array of button data\n   * @param {boolean} isRestored - Whether these buttons are being restored from history\n   * @override\n   */\n  addButtons(buttons, isRestored = false) {\n    const buttonsContainer = document.createElement(\"div\");\n    buttonsContainer.className = \"buttons-container\";\n\n    buttons.forEach((buttonData) => {\n      const button = document.createElement(\"button-component\");\n      button.setAttribute(\"label\", buttonData.name);\n      button.setAttribute(\"payload\", JSON.stringify(buttonData.request));\n\n      // Add any additional attributes needed for restored buttons\n      if (isRestored) {\n        button.setAttribute(\"data-restored\", \"true\");\n      }\n\n      buttonsContainer.appendChild(button);\n    });\n\n    this.messageContainer.appendChild(buttonsContainer);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Add a carousel to the chat\n   * @param {Array} items - Array of carousel items\n   * @param {boolean} isRestored - Whether this carousel is being restored from history\n   * @override\n   */\n  addCarousel(items, isRestored = false) {\n    const carousel = document.createElement(\"carousel-component\");\n    carousel.setAttribute(\"items\", JSON.stringify(items));\n\n    // Add any additional attributes needed for restored carousels\n    if (isRestored) {\n      carousel.setAttribute(\"data-restored\", \"true\");\n    }\n\n    this.messageContainer.appendChild(carousel);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Set up event listeners for footer elements\n   * @private\n   */\n  setupFooterEventListeners() {\n    if (!this.footer) return;\n\n    // Handle clear history button\n    const clearButton = this.footer.querySelector(\".clear-history\");\n    if (clearButton) {\n      clearButton.addEventListener(\"click\", () => {\n        this.clearChat();\n        this.eventBus.emit(MAIN_CHATBOT.CLEAR_HISTORY);\n      });\n    }\n\n    // Handle minimize button\n    const minimizeButton = this.footer.querySelector(\".minimize-chatbot\");\n    if (minimizeButton) {\n      minimizeButton.addEventListener(\"click\", () => {\n        this.eventBus.emit(MAIN_CHATBOT.MINIMIZE);\n      });\n    }\n  }\n\n  /**\n   * Clear the chat\n   * @private\n   */\n  clearChat() {\n    while (this.messageContainer.firstChild) {\n      this.messageContainer.removeChild(this.messageContainer.firstChild);\n    }\n  }\n\n  /**\n   * Update the footer visibility\n   * @public\n   */\n  updateFooterVisibility(visible) {\n    if (this.footer) {\n      this.footer.style.display = visible ? \"flex\" : \"none\";\n    }\n  }\n}\n"],"names":["MainChatbotUI","BaseChatbotUI","shadowRoot","eventBus","button","payload","label","MAIN_CHATBOT","carouselButton","buttons","isRestored","buttonsContainer","buttonData","items","carousel","clearButton","minimizeButton","visible"],"mappings":"2HAUO,MAAMA,UAAsBC,CAAc,CAK/C,YAAYC,EAAYC,EAAU,CAChC,MAAMD,EAAYC,CAAQ,EAC1B,KAAK,mBAAkB,CACxB,CAMD,oBAAqB,CAEnB,KAAK,OAAS,KAAK,WAAW,cAAc,iBAAiB,EAC7D,KAAK,0BAAyB,CAC/B,CAOD,qBAAsB,CACpB,MAAM,oBAAmB,EAGzB,KAAK,iBAAiB,iBAAiB,QAAU,GAAM,CACrD,MAAMC,EAAS,EAAE,OAAO,QAAQ,kBAAkB,EAClD,GAAIA,EAAQ,CACV,MAAMC,EAAU,KAAK,MAAMD,EAAO,aAAa,SAAS,CAAC,EACnDE,EAAQF,EAAO,aAAa,OAAO,EAEzC,KAAK,SAAS,KAAKG,EAAa,aAAc,CAC5C,GAAGF,EACH,MAAAC,EACA,KAAM,QAChB,CAAS,EAGD,KAAK,WAAW,OAAQA,CAAK,EAC7B,KAAK,0BAAyB,CAC/B,CACP,CAAK,EAGD,KAAK,iBAAiB,iBAAiB,QAAU,GAAM,CACrD,MAAME,EAAiB,EAAE,OAAO,QAAQ,iBAAiB,EACzD,GAAIA,EAAgB,CAClB,MAAMH,EAAU,KAAK,MAAMG,EAAe,aAAa,SAAS,CAAC,EAC3DF,EAAQE,EAAe,aAAa,OAAO,EAEjD,KAAK,SAAS,KAAKD,EAAa,sBAAuB,CACrD,GAAGF,EACH,MAAAC,EACA,KAAM,gBAChB,CAAS,EAGD,KAAK,WAAW,OAAQA,CAAK,CAC9B,CACP,CAAK,CACF,CAQD,WAAWG,EAASC,EAAa,GAAO,CACtC,MAAMC,EAAmB,SAAS,cAAc,KAAK,EACrDA,EAAiB,UAAY,oBAE7BF,EAAQ,QAASG,GAAe,CAC9B,MAAMR,EAAS,SAAS,cAAc,kBAAkB,EACxDA,EAAO,aAAa,QAASQ,EAAW,IAAI,EAC5CR,EAAO,aAAa,UAAW,KAAK,UAAUQ,EAAW,OAAO,CAAC,EAG7DF,GACFN,EAAO,aAAa,gBAAiB,MAAM,EAG7CO,EAAiB,YAAYP,CAAM,CACzC,CAAK,EAED,KAAK,iBAAiB,YAAYO,CAAgB,EAClD,KAAK,eAAc,CACpB,CAQD,YAAYE,EAAOH,EAAa,GAAO,CACrC,MAAMI,EAAW,SAAS,cAAc,oBAAoB,EAC5DA,EAAS,aAAa,QAAS,KAAK,UAAUD,CAAK,CAAC,EAGhDH,GACFI,EAAS,aAAa,gBAAiB,MAAM,EAG/C,KAAK,iBAAiB,YAAYA,CAAQ,EAC1C,KAAK,eAAc,CACpB,CAMD,2BAA4B,CAC1B,GAAI,CAAC,KAAK,OAAQ,OAGlB,MAAMC,EAAc,KAAK,OAAO,cAAc,gBAAgB,EAC1DA,GACFA,EAAY,iBAAiB,QAAS,IAAM,CAC1C,KAAK,UAAS,EACd,KAAK,SAAS,KAAKR,EAAa,aAAa,CACrD,CAAO,EAIH,MAAMS,EAAiB,KAAK,OAAO,cAAc,mBAAmB,EAChEA,GACFA,EAAe,iBAAiB,QAAS,IAAM,CAC7C,KAAK,SAAS,KAAKT,EAAa,QAAQ,CAChD,CAAO,CAEJ,CAMD,WAAY,CACV,KAAO,KAAK,iBAAiB,YAC3B,KAAK,iBAAiB,YAAY,KAAK,iBAAiB,UAAU,CAErE,CAMD,uBAAuBU,EAAS,CAC1B,KAAK,SACP,KAAK,OAAO,MAAM,QAAUA,EAAU,OAAS,OAElD,CACH"}