{"version":3,"file":"chatbot-components.Cthy4L0k.js","sources":["../frontend/utils/markdown-util.js","../frontend/components/ui/button-component.js","../frontend/components/ui/message-component.js","../frontend/components/ui/carousel-component.js","../frontend/components/ui/chatbot-components.js"],"sourcesContent":["// /assets/scripts/chatbot/utils/markdown-util.js\n\nimport { marked } from \"marked\";\n\n/**\n * Markdown Parser\n * Converts markdown syntax to HTML using the marked library.\n *\n * @param {string} text - The markdown text to parse.\n * @returns {string} - The HTML string.\n */\nexport function parseMarkdown(text) {\n  if (!text) return \"\";\n\n  // Clean up markdown headers that might have been split across chunks\n  const cleanedText = text.replace(/([^\\n])(#+ )/g, \"$1\\n$2\");\n\n  // Parse the cleaned markdown\n  return marked.parse(cleanedText);\n}\n","// /assets/scripts/chatbot/components/button-component.js\n\nexport class ButtonComponent extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: \"open\" });\n    this._eventBus = null; // Will be set via setter\n  }\n\n  set eventBus(bus) {\n    this._eventBus = bus;\n  }\n\n  connectedCallback() {\n    const label = this.getAttribute(\"label\");\n    const payload = this.getAttribute(\"payload\");\n    this.render(label, payload);\n  }\n\n  /**\n   * Renders the button with embedded styles.\n   * @param {string} label - The button label\n   * @param {string} payload - The button payload in JSON string format\n   */\n  render(label, payload) {\n    this.shadowRoot.innerHTML = `\n      <style>\n        .button-container {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 10px;\n          margin-bottom: var(--spacing-4);\n        }\n\n        .button {\n          padding: var(--spacing-3);\n          background-color: #FFFFFF;\n          border: none;\n          border-radius: var(--rounded);\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 14px;\n          transition: background-color 0.3s ease;\n        }\n\n        .button:hover {\n          background-color: #f0f0f0;\n        }\n      </style>\n      <div class=\"button-container\">\n        <button class=\"button\" data-button-data='${payload}' aria-label=\"${label}\">${label}</button>\n      </div>\n    `;\n\n    this.shadowRoot.querySelector(\".button\").addEventListener(\"click\", () => {\n      if (!this._eventBus) {\n        console.error(\"No eventBus assigned to ButtonComponent\");\n        return;\n      }\n\n      try {\n        const parsedPayload = JSON.parse(payload);\n        this._eventBus.emit(\"buttonClicked\", parsedPayload);\n      } catch (error) {\n        console.error(\"Error parsing button payload:\", error);\n      }\n    });\n  }\n}\n","// /assets/scripts/chatbot/components/message-component.js\n\nimport { parseMarkdown } from \"../../utils/markdown-util.js\";\n\nexport class MessageComponent extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: \"open\" });\n    this.content = \"\"; // Initialize empty content\n    this.animationFrameId = null; // To track the current animation frame\n    this.defaultAnimationSpeed = 15; // milliseconds per character (quicker)\n    this.currentAnimationSpeed = this.defaultAnimationSpeed;\n    this.shouldAnimate = true;\n\n    this.buffer = \"\"; // Buffer to accumulate incoming chunks\n  }\n\n  connectedCallback() {\n    const sender = this.getAttribute(\"sender\");\n    const initialContent = this.getAttribute(\"content\") || \"\";\n    this.content = initialContent;\n\n    // Determine if animation should occur\n    const animateAttr = this.getAttribute(\"data-animate\");\n    this.shouldAnimate = animateAttr !== \"false\"; // default to true\n\n    // Determine animation speed\n    const animationSpeedAttr = this.getAttribute(\"data-animation-speed\");\n    if (animationSpeedAttr) {\n      const speed = parseInt(animationSpeedAttr, 10);\n      if (!isNaN(speed)) {\n        this.currentAnimationSpeed = speed;\n      }\n    } else {\n      this.currentAnimationSpeed = this.defaultAnimationSpeed;\n    }\n\n    this.render(sender, this.content);\n  }\n\n  /**\n   * Append new content to the buffer and process it for Markdown elements.\n   * @param {string} newContent - The new content to append\n   */\n  appendContent(newContent) {\n    this.buffer += newContent;\n    this.processBuffer();\n  }\n\n  /**\n   * Processes the buffer, extracting and rendering complete Markdown elements.\n   */\n  processBuffer() {\n    let processedLength = 0;\n    while (processedLength < this.buffer.length) {\n      const extractionResult = this.extractNextMarkdownElement(\n        this.buffer.slice(processedLength)\n      );\n\n      if (!extractionResult) {\n        break; // Not enough content to form a complete element\n      }\n\n      const { elementContent, length } = extractionResult;\n      this.appendContentStreamedBuffered(elementContent);\n      processedLength += length;\n    }\n    this.buffer = this.buffer.slice(processedLength); // Update buffer\n  }\n\n  /**\n   * Extracts the next complete Markdown element from the buffer.\n   * @param {string} buffer - The current buffer\n   * @returns {Object|null} - Object containing the element content and length, or null if no complete element found.\n   */\n  extractNextMarkdownElement(buffer) {\n    // Check for headings\n    const headingMatch = buffer.match(/^(#+)\\s+([^\\n]+?)\\n/);\n    if (headingMatch) {\n      return {\n        elementContent: headingMatch[0],\n        length: headingMatch[0].length,\n      };\n    }\n\n    // Check for ordered lists\n    const orderedListMatch = buffer.match(/^(\\d+)\\.\\s+([^\\n]+?)(?:\\n|$)/m);\n    if (orderedListMatch) {\n      const listBlock = buffer.substring(\n        0,\n        buffer.indexOf(\n          buffer.match(/^(\\d+)\\.\\s+([^\\n]+?)(?:\\n|$)/m, \"gm\").slice(-1)[0]\n        ) +\n          buffer.match(/^(\\d+)\\.\\s+([^\\n]+?)(?:\\n|$)/m, \"gm\").slice(-1)[0]\n            .length\n      );\n      return { elementContent: listBlock, length: listBlock.length };\n    }\n\n    // Check for unordered lists\n    const unorderedListMatch = buffer.match(/^([*\\-+])\\s+([^\\n]+?)(?:\\n|$)/m);\n    if (unorderedListMatch) {\n      const listBlock = buffer.substring(\n        0,\n        buffer.indexOf(\n          buffer.match(/^([*\\-+])\\s+([^\\n]+?)(?:\\n|$)/m, \"gm\").slice(-1)[0]\n        ) +\n          buffer.match(/^([*\\-+])\\s+([^\\n]+?)(?:\\n|$)/m, \"gm\").slice(-1)[0]\n            .length\n      );\n      return { elementContent: listBlock, length: listBlock.length };\n    }\n\n    // Check for bold (**...**)\n    const boldMatch = buffer.match(/\\*\\*([^*]+?)\\*\\*/);\n    if (boldMatch) {\n      return { elementContent: boldMatch[0], length: boldMatch[0].length };\n    }\n\n    // Check for italics (*...*)\n    const italicMatch = buffer.match(/\\*([^*]+?)\\*/);\n    if (italicMatch) {\n      return { elementContent: italicMatch[0], length: italicMatch[0].length };\n    }\n\n    // Check for paragraphs (non-empty line not starting with #, *, -, +, or number followed by dot, ending with double newline or end of buffer)\n    const paragraphMatch = buffer.match(\n      /^(?!(#|\\*|\\-|\\+|\\d+\\.))([^\\n]+?)(?:\\n\\n+|$)/\n    );\n    if (paragraphMatch) {\n      return {\n        elementContent: paragraphMatch[0],\n        length: paragraphMatch[0].length,\n      };\n    }\n\n    return null; // No complete element found\n  }\n\n  /**\n   * Append content for streamed messages with buffering of markdown elements.\n   * @param {string} markdownContent - The complete markdown element content to append\n   */\n  appendContentStreamedBuffered(markdownContent) {\n    const messageContent = this.shadowRoot.querySelector(\".message__content\");\n    if (!messageContent) return;\n\n    const parsedHTML = parseMarkdown(markdownContent);\n    const tempDiv = document.createElement(\"div\");\n    tempDiv.innerHTML = parsedHTML;\n\n    // Append the parsed HTML\n    while (tempDiv.firstChild) {\n      messageContent.appendChild(tempDiv.firstChild);\n    }\n\n    this.scrollToBottom();\n  }\n\n  /**\n   * Update the entire message content and re-render with markdown\n   * @param {string} newContent - The new content to set\n   */\n  updateContent(newContent) {\n    this.content = newContent;\n    const messageContent = this.shadowRoot.querySelector(\".message__content\");\n    if (messageContent) {\n      messageContent.innerHTML = parseMarkdown(newContent);\n    }\n  }\n\n  render(sender, content) {\n    const isAssistant = sender === \"assistant\";\n    this.shadowRoot.innerHTML = `\n      <style>\n        :host {\n          display: block;\n          width: 100%;\n        }\n        p {\n          margin-top: var(--spacing-1);\n          margin-bottom: var(--spacing-1);\n        }\n        .message-wrapper {\n          display: flex;\n          align-items: flex-end;\n          width: 100%;\n          margin-bottom: var(--spacing-6);\n          gap: var(--spacing-2);\n        }\n\n        .message-wrapper--assistant {\n          justify-content: flex-start;\n        }\n\n        .message-wrapper--user {\n          justify-content: flex-end;\n        }\n\n        .assistant-icon {\n          width: 30px;\n          height: 20px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          margin-right: var(--spacing-2);\n        }\n\n        .message {\n          display: flex;\n          max-width: 80%;\n          padding: var(--spacing-4);\n          border-radius: 20px;\n          word-wrap: break-word;\n          background-color: ${\n            isAssistant ? \"#FFFFFF\" : \"rgba(255, 255, 255, 0.1)\"\n          };\n          color: ${isAssistant ? \"#231F25\" : \"#FFFFFF\"};\n          border: ${isAssistant ? \"none\" : \"1px solid #FFFFFF\"};\n          overflow: hidden;\n          white-space: pre-wrap;\n          font-family: inherit;\n        }\n\n        .message--assistant {\n          background-color: #FFFFFF;\n          color: #231F25 !important;\n          border-bottom-left-radius: 4px;\n        }\n\n        .message--user {\n          background-color: rgba(255, 255, 255, 0.1);\n          border: 1px solid #FFFFFF;\n          color: white;\n        }\n\n        .message__content {\n          display: flex;\n          flex-direction: column;\n          flex-grow: 1;\n          font-family: inherit;\n        }\n\n        /* Markdown styling */\n        .message__content h1,\n        .message__content h2,\n        .message__content h3,\n        .message__content h4,\n        .message__content h5,\n        .message__content h6 {\n          margin: 1em 0 0.5em 0;\n          line-height: 1.2;\n        }\n\n        .message__content h1:first-child,\n        .message__content h2:first-child,\n        .message__content h3:first-child,\n        .message__content h4:first-child,\n        .message__content h5:first-child,\n        .message__content h6:first-child {\n          margin-top: 0;\n        }\n\n        .message__content h1 { font-size: 1.6em; }\n        .message__content h2 { font-size: 1.4em; }\n        .message__content h3 { font-size: 1.2em; }\n        .message__content h4 { font-size: 1.1em; }\n        .message__content h5 { font-size: 1em; }\n        .message__content h6 { font-size: 0.9em; }\n\n        .message__content a {\n          color: #0066cc;\n          text-decoration: none;\n        }\n\n        .message__content a:hover {\n          text-decoration: underline;\n        }\n\n        .message__content p {\n          margin: 0.5em 0;\n          line-height: 1.4;\n        }\n\n        .message__content ul,\n        .message__content ol {\n          margin: 0.5em 0;\n          padding-left: 2em;\n        }\n\n        .message__content li {\n          margin: 0.25em 0;\n        }\n\n        .message__content code {\n          background-color: rgba(0, 0, 0, 0.05);\n          padding: 0.2em 0.4em;\n          border-radius: 3px;\n          font-family: monospace;\n        }\n\n        .message__content pre {\n          background-color: rgba(0, 0, 0, 0.05);\n          padding: 1em;\n          border-radius: 4px;\n          overflow-x: auto;\n          margin: 0.5em 0;\n        }\n\n        .message__content pre code {\n          background-color: transparent;\n          padding: 0;\n          border-radius: 0;\n        }\n\n        .message__content blockquote {\n          margin: 0.5em 0;\n          padding-left: 1em;\n          border-left: 4px solid rgba(0, 0, 0, 0.1);\n          color: rgba(0, 0, 0, 0.7);\n        }\n\n        .message__content img {\n          max-width: 100%;\n          height: auto;\n        }\n\n        .message__content table {\n          border-collapse: collapse;\n          margin: 0.5em 0;\n          width: 100%;\n        }\n\n        .message__content th,\n        .message__content td {\n          border: 1px solid rgba(0, 0, 0, 0.1);\n          padding: 0.4em 0.8em;\n          text-align: left;\n        }\n\n        .message__content th {\n          background-color: rgba(0, 0, 0, 0.05);\n        }\n      </style>\n      <div class=\"message-wrapper message-wrapper--${sender}\">\n        ${isAssistant ? `<div class=\"assistant-icon\">ðŸ¤–</div>` : \"\"}\n        <div class=\"message message--${sender}\">\n          <div class=\"message__content\"></div>\n        </div>\n      </div>\n    `;\n\n    if (isAssistant && this.shouldAnimate) {\n      this.animateContent(content);\n    } else if (isAssistant && !this.shouldAnimate) {\n      this.updateContentStreamedBuffered(content); // Use the buffered version for initial content\n    } else {\n      this.updateContent(content);\n    }\n  }\n\n  /**\n   * Animates the message content by revealing it character by character\n   * @param {string} content - The raw markdown content to animate\n   */\n  async animateContent(content) {\n    const messageContent = this.shadowRoot.querySelector(\".message__content\");\n    if (!messageContent) return;\n\n    const parsedHTML = parseMarkdown(content);\n    const tempDiv = document.createElement(\"div\");\n    tempDiv.innerHTML = parsedHTML;\n\n    await this.animateNodes(messageContent, Array.from(tempDiv.childNodes));\n  }\n\n  /**\n   * Animate nodes recursively\n   * @param {HTMLElement} container - Container to append animated content\n   * @param {Array<Node>} nodes - Array of nodes to animate\n   */\n  async animateNodes(container, nodes) {\n    for (const node of nodes) {\n      if (node.nodeType === Node.TEXT_NODE) {\n        if (node.textContent.trim()) {\n          await this.animateText(container, node.textContent);\n        }\n      } else if (node.nodeType === Node.ELEMENT_NODE) {\n        const element = document.createElement(node.tagName);\n\n        // Copy attributes\n        for (const attr of node.attributes || []) {\n          element.setAttribute(attr.name, attr.value);\n        }\n\n        container.appendChild(element);\n        await this.animateNodes(element, Array.from(node.childNodes));\n      }\n    }\n  }\n  /**\n   * Recursively animates HTML nodes one after another\n   * @param {HTMLElement} container - The container to append animated nodes\n   * @param {NodeList} nodes - The list of nodes to animate\n   * @returns {Promise} - Resolves when all nodes are animated\n   */\n  async animateNodesSequentially(container, nodes) {\n    const blockLevelElements = new Set([\n      \"p\",\n      \"div\",\n      \"h1\",\n      \"h2\",\n      \"h3\",\n      \"ul\",\n      \"ol\",\n      \"li\",\n      \"blockquote\",\n      \"pre\",\n      \"h4\",\n      \"h5\",\n      \"h6\",\n    ]);\n\n    for (const node of nodes) {\n      if (node.nodeType === Node.TEXT_NODE) {\n        // Skip empty or whitespace-only text nodes\n        if (node.textContent.trim() === \"\") continue;\n        await this.animateTextNode(container, node.textContent);\n      } else if (node.nodeType === Node.ELEMENT_NODE) {\n        const tagName = node.tagName.toLowerCase();\n        const isBlock = blockLevelElements.has(tagName);\n\n        const element = document.createElement(tagName);\n\n        // Copy attributes\n        Array.from(node.attributes).forEach((attr) => {\n          element.setAttribute(attr.name, attr.value);\n        });\n\n        container.appendChild(element);\n\n        if (isBlock) {\n          // Animate child nodes without wrapping in spans\n          await this.animateNodesSequentially(element, node.childNodes);\n        } else {\n          // For inline elements, animate child nodes\n          await this.animateNodesSequentially(element, node.childNodes);\n        }\n      }\n    }\n  }\n\n  /**\n   * Animates a text node by revealing it character by character using requestAnimationFrame\n   * @param {HTMLElement} container - The container to append the text\n   * @param {string} text - The text content to animate\n   * @returns {Promise} - Resolves when animation is complete\n   */\n  animateTextNode(container, text) {\n    return new Promise((resolve) => {\n      let index = 0;\n      const span = document.createElement(\"span\");\n      container.appendChild(span);\n\n      let lastTime = performance.now();\n\n      const animate = (currentTime) => {\n        const deltaTime = currentTime - lastTime;\n        if (deltaTime >= this.currentAnimationSpeed) {\n          span.textContent += text[index];\n          index++;\n          this.scrollToBottom();\n          lastTime = currentTime;\n        }\n        if (index < text.length) {\n          this.animationFrameId = requestAnimationFrame(animate);\n        } else {\n          resolve();\n        }\n      };\n\n      this.animationFrameId = requestAnimationFrame(animate);\n    });\n  }\n\n  /**\n   * Scroll the message container to the bottom\n   * @private\n   */\n  scrollToBottom() {\n    this.parentElement.scrollTop = this.parentElement.scrollHeight;\n  }\n\n  /**\n   * Clean up any ongoing animations when the component is disconnected\n   */\n  disconnectedCallback() {\n    if (this.animationFrameId) {\n      cancelAnimationFrame(this.animationFrameId);\n    }\n  }\n}\n","// /assets/scripts/chatbot/components/carousel-component.js\n\nexport class CarouselComponent extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: \"open\" });\n    this._eventBus = null; // Will be set via setter\n\n    // Initialize properties\n    this.items = []; // To store carousel items\n    this.currentIndex = 0; // Current slide index\n    this.isDesktop = window.matchMedia(\"(min-width: 1000px)\").matches;\n    this.itemsPerSlide = this.isDesktop ? 2 : 1;\n\n    // Bind methods\n    this.moveLeft = this.moveLeft.bind(this);\n    this.moveRight = this.moveRight.bind(this);\n    this.handleResize = this.handleResize.bind(this);\n    this.handleButtonClick = this.handleButtonClick.bind(this);\n  }\n\n  set eventBus(bus) {\n    this._eventBus = bus;\n  }\n\n  connectedCallback() {\n    const dataAttr = this.getAttribute(\"data-carousel\");\n    if (!dataAttr) {\n      console.error(\n        \"No data-carousel attribute found. Cannot render carousel.\"\n      );\n      return;\n    }\n\n    let carouselData;\n    try {\n      carouselData = JSON.parse(dataAttr);\n    } catch (err) {\n      console.error(\"Failed to parse carousel data:\", err);\n      return;\n    }\n\n    // Ensure carouselData.cards is an array\n    if (!carouselData || !Array.isArray(carouselData.cards)) {\n      console.error(\"carouselData.cards is not defined or not an array\");\n      return;\n    }\n\n    this.renderCarousel(carouselData);\n  }\n\n  /**\n   * Renders the carousel with embedded styles and initializes functionality.\n   * @param {Object} carouselData - Data for the carousel containing a 'cards' array.\n   */\n  renderCarousel(carouselData) {\n    this.carouselData = carouselData;\n    this.shadowRoot.innerHTML = `\n      <style>\n        h6 {\n          font-family: var(--heading-font-family);\n          font-weight: var(--heading-font-weight);\n          font-style: var(--heading-font-style);\n          letter-spacing: var(--heading-letter-spacing);\n          text-transform: var(--heading-text-transform);\n          overflow-wrap: anywhere;\n          font-size: var(--text-sm);\n        }\n\n        .button {\n          --button-background: var(--button-background-primary) /\n            var(--button-background-opacity, 1);\n          --button-text-color: var(--button-text-primary);\n          --button-outline-color: white;\n          -webkit-appearance: none;\n          appearance: none;\n          border-color: white;\n          border-radius: 8px;\n          border-width: 1px;\n          background-color: rgb(var(--button-background));\n          color: rgb(var(--button-text-color));\n          text-align: center;\n          font-size: var(--text-h6);\n          letter-spacing: var(--text-letter-spacing);\n          padding-block-start: var(--spacing-2-5);\n          padding-block-end: var(--spacing-2-5);\n          padding-inline-start: var(--spacing-5);\n          padding-inline-end: var(--spacing-5);\n          font-weight: bold;\n          line-height: 1.6;\n          transition: background-color 0.15s ease-in-out, color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n          display: inline-block;\n          position: relative;\n        }\n\n        .carousel {\n          position: relative;\n          width: 100%;\n          overflow: hidden;\n          margin-bottom: var(--spacing-4);\n          box-sizing: border-box;\n        }\n\n        .carousel__container {\n          display: flex;\n          transition: transform 0.3s ease-out;\n          max-width: 100%;\n        }\n\n        .carousel__item {\n          flex: 0 0 100%;\n          display: flex;\n          gap: var(--spacing-4);\n          box-sizing: border-box;\n          max-width: 100%;\n          align-items: flex-start;\n        }\n\n        .carousel__item-wrapper {\n          flex: 0 0 100%;\n          max-width: 100%;\n          min-width: 0;\n        }\n\n        .carousel__button {\n          position: absolute;\n          top: 50%;\n          transform: translateY(-50%);\n          background: rgba(255, 255, 255, 0.8);\n          border: solid 1px #403545;\n          width: 40px;\n          height: 40px;\n          border-radius: 50%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          cursor: pointer;\n          z-index: 2;\n        }\n\n        .carousel__button--left {\n          left: 10px;\n        }\n\n        .carousel__button--right {\n          right: 10px;\n        }\n\n        .carousel__item-button {\n          font-size: var(--text-sm);\n        }\n\n        .carousel__item-content {\n          background: #FFFFFF;\n          border-radius: 8px;\n          padding: var(--spacing-4);\n          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n        }\n\n        .carousel__item-image {\n          width: 100%;\n          height: auto;\n          border-radius: 8px;\n          margin-bottom: var(--spacing-2);\n          object-fit: cover;\n        }\n\n        .carousel__item-title {\n          font-weight: bold;\n          margin-bottom: var(--spacing-0);\n          margin-top: var(--spacing-0);\n          font-size: var(--text-base);\n        }\n\n        .carousel__item-description {\n          margin-bottom: var(--spacing-4);\n          margin-top: var(--spacing-0);\n          font-size: var(--text-sm);\n          color: #403545 !important;\n          flex-grow: 1;\n        }\n\n        @media (min-width: 1000px) {\n          .carousel__item {\n            flex: 0 0 50%;\n            max-width: 50%;\n          }\n\n          .carousel__item-wrapper {\n            flex: 0 0 calc(100% - var(--spacing-2));\n            max-width: calc(100% - var(--spacing-2));\n          }\n        }\n      </style>\n      <div class=\"carousel\">\n        <div class=\"carousel__container\">\n          <!-- Items appended here -->\n        </div>\n        <button class=\"carousel__button carousel__button--left\" aria-label=\"Previous slide\">\n          <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"\n               xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M15 18L9 12L15 6\" stroke=\"currentColor\" stroke-width=\"2\"\n                  stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          </svg>\n        </button>\n        <button class=\"carousel__button carousel__button--right\" aria-label=\"Next slide\">\n          <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"\n               xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M9 18L15 12L9 6\" stroke=\"currentColor\" stroke-width=\"2\"\n                  stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          </svg>\n        </button>\n      </div>\n    `;\n\n    this.carouselContainer = this.shadowRoot.querySelector(\n      \".carousel__container\"\n    );\n    this.leftButton = this.shadowRoot.querySelector(\".carousel__button--left\");\n    this.rightButton = this.shadowRoot.querySelector(\n      \".carousel__button--right\"\n    );\n\n    this.carouselData.cards.forEach((card, index) => {\n      const item = document.createElement(\"div\");\n      item.classList.add(\"carousel__item\");\n\n      const itemWrapper = document.createElement(\"div\");\n      itemWrapper.classList.add(\"carousel__item-wrapper\");\n\n      const itemContent = document.createElement(\"div\");\n      itemContent.classList.add(\"carousel__item-content\");\n\n      if (card.imageUrl) {\n        const img = document.createElement(\"img\");\n        img.src = card.imageUrl;\n        img.alt = card.title || \"\";\n        img.classList.add(\"carousel__item-image\");\n        itemContent.appendChild(img);\n      }\n\n      if (card.title) {\n        const title = document.createElement(\"h6\");\n        title.classList.add(\"carousel__item-title\");\n        title.textContent = card.title;\n        itemContent.appendChild(title);\n      }\n\n      if (card.description && card.description.text) {\n        const description = document.createElement(\"p\");\n        description.classList.add(\"carousel__item-description\");\n        description.textContent = card.description.text;\n        itemContent.appendChild(description);\n      }\n\n      // If the card has buttons, create a button\n      if (card.buttons && card.buttons.length > 0) {\n        const buttonData = card.buttons[0];\n        const button = document.createElement(\"button\");\n        button.classList.add(\"button\", \"carousel__item-button\");\n        button.setAttribute(\"data-button-index\", index);\n        button.setAttribute(\n          \"data-button-payload\",\n          JSON.stringify(buttonData.request)\n        );\n        button.setAttribute(\"data-button-text\", buttonData.name);\n        button.textContent = buttonData.name || \"Select\";\n        itemContent.appendChild(button);\n        button.addEventListener(\"click\", this.handleButtonClick);\n      }\n\n      itemWrapper.appendChild(itemContent);\n      item.appendChild(itemWrapper);\n      this.carouselContainer.appendChild(item);\n      this.items.push(item);\n    });\n\n    this.initCarousel();\n\n    this.leftButton.addEventListener(\"click\", this.moveLeft);\n    this.rightButton.addEventListener(\"click\", this.moveRight);\n    window.addEventListener(\"resize\", this.handleResize);\n\n    this.updateVisibility();\n    this.updatePosition();\n  }\n\n  initCarousel() {\n    this.isDesktop = window.matchMedia(\"(min-width: 1000px)\").matches;\n    this.itemsPerSlide = this.isDesktop ? 2 : 1;\n    this.currentIndex = 0;\n    this.updateVisibility();\n    this.updatePosition();\n  }\n\n  handleResize() {\n    this.isDesktop = window.matchMedia(\"(min-width: 1000px)\").matches;\n    this.itemsPerSlide = this.isDesktop ? 2 : 1;\n    this.currentIndex = 0;\n    this.updatePosition();\n    this.updateVisibility();\n  }\n\n  moveLeft() {\n    const itemsPerSlide = this.itemsPerSlide;\n    this.currentIndex = Math.max(0, this.currentIndex - itemsPerSlide);\n    this.updatePosition();\n    this.updateVisibility();\n  }\n\n  moveRight() {\n    const itemsPerSlide = this.itemsPerSlide;\n    this.currentIndex = Math.min(\n      this.items.length - itemsPerSlide,\n      this.currentIndex + itemsPerSlide\n    );\n    this.updatePosition();\n    this.updateVisibility();\n  }\n\n  updatePosition() {\n    const offset = -(this.currentIndex / this.itemsPerSlide) * 100;\n    this.carouselContainer.style.transform = `translateX(${offset}%)`;\n  }\n\n  updateVisibility() {\n    this.leftButton.disabled = this.currentIndex === 0;\n    this.rightButton.disabled =\n      this.currentIndex >= this.items.length - this.itemsPerSlide;\n  }\n\n  handleButtonClick(e) {\n    if (!this._eventBus) {\n      console.error(\"No eventBus assigned to CarouselComponent\");\n      return;\n    }\n\n    const button = e.target;\n    const buttonIndex = parseInt(button.getAttribute(\"data-button-index\"), 10);\n    const card = this.carouselData.cards[buttonIndex];\n\n    if (!card || !card.buttons || card.buttons.length === 0) {\n      console.warn(\"No button data found for this card.\");\n      return;\n    }\n\n    const buttonData = card.buttons[0];\n    console.log(\"Original button data:\", buttonData);\n\n    const productTitle = buttonData.request.payload.title;\n    const displayLabel = productTitle\n      ? `Selected ${productTitle}`\n      : \"Selected Power Station\";\n\n    this._eventBus.emit(\"carouselButtonClicked\", {\n      action: buttonData.request,\n      label: displayLabel,\n    });\n\n    // Remove the carousel after interaction\n    this.remove();\n  }\n}\n","// frontend/components/ui/chatbot-components.js\nimport { ButtonComponent } from \"./button-component.js\";\nimport { MessageComponent } from \"./message-component.js\";\nimport { CarouselComponent } from \"./carousel-component.js\";\n\n// Register custom components\ncustomElements.define(\"button-component\", ButtonComponent);\ncustomElements.define(\"message-component\", MessageComponent);\ncustomElements.define(\"carousel-component\", CarouselComponent);\nconsole.log(\"MessageComponent defined\");\nconsole.log(\"ButtonComponent defined\");\nconsole.log(\"CarouselComponent defined\");\n"],"names":["parseMarkdown","text","cleanedText","marked","ButtonComponent","bus","label","payload","parsedPayload","error","MessageComponent","sender","initialContent","animateAttr","animationSpeedAttr","speed","newContent","processedLength","extractionResult","elementContent","length","buffer","headingMatch","listBlock","boldMatch","italicMatch","paragraphMatch","markdownContent","messageContent","parsedHTML","tempDiv","content","isAssistant","container","nodes","node","element","attr","blockLevelElements","tagName","isBlock","resolve","index","span","lastTime","animate","currentTime","CarouselComponent","dataAttr","carouselData","err","card","item","itemWrapper","itemContent","img","title","description","buttonData","button","itemsPerSlide","offset","e","buttonIndex","productTitle","displayLabel"],"mappings":"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"}