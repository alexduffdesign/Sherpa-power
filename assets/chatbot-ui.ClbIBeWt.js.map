{"version":3,"file":"chatbot-ui.ClbIBeWt.js","sources":["../frontend/entrypoints/chatbot-ui.js"],"sourcesContent":["export class UIManager {\n  constructor() {\n    this.messageContainer = null;\n    this.typingIndicator = null;\n    this.drawerBody = null;\n  }\n\n  setDOMElements(messageContainer, typingIndicator, drawerBody) {\n    this.messageContainer = messageContainer;\n    this.typingIndicator = typingIndicator;\n    this.drawerBody = drawerBody;\n  }\n\n  addMessage(role, message) {\n    if (!this.messageContainer) return;\n\n    const messageDiv = document.createElement(\"div\");\n    messageDiv.className = \"message\";\n\n    const contentDiv = document.createElement(\"div\");\n    contentDiv.className = `message-content ${role}-message`;\n\n    // For assistant messages, add the logo\n    if (role === \"assistant\") {\n      const logoContainer = document.createElement(\"div\");\n      logoContainer.className = \"logo-container\";\n      const logoBg = document.createElement(\"div\");\n      logoBg.className = \"logo-background\";\n      logoContainer.appendChild(logoBg);\n      contentDiv.appendChild(logoContainer);\n    }\n\n    const textDiv = document.createElement(\"div\");\n    textDiv.className = \"message-text\";\n    textDiv.innerHTML = message; // Use innerHTML to support HTML in messages\n\n    contentDiv.appendChild(textDiv);\n    messageDiv.appendChild(contentDiv);\n    this.messageContainer.appendChild(messageDiv);\n    this.scrollToBottom();\n  }\n\n  addCarousel(payload) {\n    if (!this.messageContainer || !payload?.data) return;\n\n    const messageDiv = document.createElement(\"div\");\n    messageDiv.className = \"message\";\n\n    const contentDiv = document.createElement(\"div\");\n    contentDiv.className = \"message-content assistant-message\";\n\n    const logoContainer = document.createElement(\"div\");\n    logoContainer.className = \"logo-container\";\n    const logoBg = document.createElement(\"div\");\n    logoBg.className = \"logo-background\";\n    logoContainer.appendChild(logoBg);\n    contentDiv.appendChild(logoContainer);\n\n    const carouselContainer = document.createElement(\"div\");\n    carouselContainer.className = \"carousel-container\";\n\n    payload.data.forEach((item, index) => {\n      const card = document.createElement(\"div\");\n      card.className = \"carousel-card\";\n\n      if (item.image) {\n        const img = document.createElement(\"img\");\n        img.src = item.image;\n        img.alt = item.title || `Carousel item ${index + 1}`;\n        img.className = \"carousel-image\";\n        card.appendChild(img);\n      }\n\n      const cardContent = document.createElement(\"div\");\n      cardContent.className = \"carousel-card-content\";\n\n      if (item.title) {\n        const title = document.createElement(\"h3\");\n        title.className = \"carousel-title\";\n        title.textContent = item.title;\n        cardContent.appendChild(title);\n      }\n\n      if (item.description) {\n        const desc = document.createElement(\"p\");\n        desc.className = \"carousel-description\";\n        desc.textContent = item.description;\n        cardContent.appendChild(desc);\n      }\n\n      card.appendChild(cardContent);\n      carouselContainer.appendChild(card);\n    });\n\n    contentDiv.appendChild(carouselContainer);\n    messageDiv.appendChild(contentDiv);\n    this.messageContainer.appendChild(messageDiv);\n    this.scrollToBottom();\n  }\n\n  addButtons(buttons) {\n    if (!this.messageContainer || !buttons?.length) return;\n\n    const messageDiv = document.createElement(\"div\");\n    messageDiv.className = \"message\";\n\n    const contentDiv = document.createElement(\"div\");\n    contentDiv.className = \"message-content assistant-message\";\n\n    const logoContainer = document.createElement(\"div\");\n    logoContainer.className = \"logo-container\";\n    const logoBg = document.createElement(\"div\");\n    logoBg.className = \"logo-background\";\n    logoContainer.appendChild(logoBg);\n    contentDiv.appendChild(logoContainer);\n\n    const buttonsContainer = document.createElement(\"div\");\n    buttonsContainer.className = \"buttons-container\";\n\n    buttons.forEach((button) => {\n      const buttonElement = document.createElement(\"button\");\n      buttonElement.className = \"chat-button\";\n      buttonElement.textContent = button.name;\n      buttonElement.dataset.buttonData = JSON.stringify(button);\n      buttonsContainer.appendChild(buttonElement);\n    });\n\n    contentDiv.appendChild(buttonsContainer);\n    messageDiv.appendChild(contentDiv);\n    this.messageContainer.appendChild(messageDiv);\n    this.scrollToBottom();\n  }\n\n  addVisualImage(payload) {\n    if (!this.messageContainer || !payload?.image) return;\n\n    const messageDiv = document.createElement(\"div\");\n    messageDiv.className = \"message\";\n\n    const contentDiv = document.createElement(\"div\");\n    contentDiv.className = \"message-content assistant-message\";\n\n    const logoContainer = document.createElement(\"div\");\n    logoContainer.className = \"logo-container\";\n    const logoBg = document.createElement(\"div\");\n    logoBg.className = \"logo-background\";\n    logoContainer.appendChild(logoBg);\n    contentDiv.appendChild(logoContainer);\n\n    const imageContainer = document.createElement(\"div\");\n    imageContainer.className = \"visual-image-container\";\n\n    const img = document.createElement(\"img\");\n    img.src = payload.image;\n    img.alt = payload.alt || \"Visual response\";\n    img.className = \"visual-image\";\n\n    imageContainer.appendChild(img);\n    contentDiv.appendChild(imageContainer);\n    messageDiv.appendChild(contentDiv);\n    this.messageContainer.appendChild(messageDiv);\n    this.scrollToBottom();\n  }\n\n  removeButtons() {\n    if (!this.messageContainer) return;\n    const buttonsContainers =\n      this.messageContainer.querySelectorAll(\".buttons-container\");\n    buttonsContainers.forEach((container) => {\n      const message = container.closest(\".message\");\n      if (message) message.remove();\n    });\n  }\n\n  showTypingIndicator(text = \"Sherpa Guide Is Typing...\") {\n    if (this.typingIndicator) {\n      const logoContainer =\n        this.typingIndicator.querySelector(\".logo-container\");\n      if (!logoContainer) {\n        const newLogoContainer = document.createElement(\"div\");\n        newLogoContainer.className = \"logo-container\";\n        const logoBg = document.createElement(\"div\");\n        logoBg.className = \"logo-background\";\n        newLogoContainer.appendChild(logoBg);\n        this.typingIndicator.insertBefore(\n          newLogoContainer,\n          this.typingIndicator.firstChild\n        );\n      }\n      this.typingIndicator.style.display = \"flex\";\n      this.scrollToBottom();\n    }\n  }\n\n  hideTypingIndicator() {\n    if (this.typingIndicator) {\n      this.typingIndicator.style.display = \"none\";\n    }\n  }\n\n  scrollToBottom() {\n    if (this.drawerBody) {\n      this.drawerBody.scrollTop = this.drawerBody.scrollHeight;\n    }\n  }\n}\n"],"names":["UIManager","messageContainer","typingIndicator","drawerBody","role","message","messageDiv","contentDiv","logoContainer","logoBg","textDiv","payload","carouselContainer","item","index","card","img","cardContent","title","desc","buttons","buttonsContainer","button","buttonElement","imageContainer","container","text","newLogoContainer"],"mappings":"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"}