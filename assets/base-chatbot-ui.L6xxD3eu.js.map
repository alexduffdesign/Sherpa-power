{"version":3,"file":"base-chatbot-ui.L6xxD3eu.js","sources":["../frontend/baseChatbot/base-chatbot-ui.js"],"sourcesContent":["// /assets/scripts/chatbot/core/base-chatbot-ui.js\n\nimport EventEmitter from \"eventemitter3\";\nimport { parseMarkdown } from \"../utils/markdown-util.js\";\n\n/**\n * ChatbotUI Class\n * Handles base UI functionality for chatbots with markdown and streaming support\n */\nclass ChatbotUI {\n  /**\n   * @param {Object} config - Configuration object\n   * @param {HTMLElement} config.container - The container element for the chatbot\n   * @param {EventEmitter} config.eventBus - Event bus instance\n   * @param {string} config.type - Type of chatbot ('main' or 'section')\n   */\n  constructor(config) {\n    if (!config.container) {\n      throw new Error(\"ChatbotUI requires a container element\");\n    }\n    if (!config.eventBus) {\n      throw new Error(\"ChatbotUI requires an event bus\");\n    }\n\n    this.container = config.container;\n    this.eventBus = config.eventBus;\n    this.type = config.type;\n\n    this.currentAssistantMessage = null; // Track the current assistant message\n    this.accumulatedContent = \"\"; // For accumulating partial messages\n\n    this.setupUIElements();\n    this.setupEventListeners();\n  }\n\n  /**\n   * Set up references to UI elements\n   * @private\n   */\n  setupUIElements() {\n    const messageContainers =\n      this.container.querySelectorAll(\".message-container\");\n    this.messageContainer = messageContainers[0];\n    console.log(\"Message container found:\", !!this.messageContainer);\n\n    const forms = this.container.querySelectorAll(\".chat-form\");\n    this.form = forms[0];\n    console.log(\"Chat form found:\", !!this.form);\n\n    const inputs = this.container.querySelectorAll(\".chatbot-input\");\n    this.input = inputs[0];\n    console.log(\"Chat input found:\", !!this.input);\n\n    const typingIndicators = this.container.querySelectorAll(\".chat-typing\");\n    this.typingIndicator = typingIndicators[0];\n    console.log(\"Typing indicator found:\", !!this.typingIndicator);\n\n    this.typingText = this.typingIndicator?.querySelector(\".typing-text\");\n    console.log(\"Typing text found:\", !!this.typingText);\n\n    console.log(\"Container HTML:\", this.container.innerHTML);\n\n    if (!this.messageContainer || !this.form || !this.input) {\n      const missing = [];\n      if (!this.messageContainer) missing.push(\"message-container\");\n      if (!this.form) missing.push(\"chat-form\");\n      if (!this.input) missing.push(\"chatbot-input\");\n      throw new Error(`Required UI elements not found: ${missing.join(\", \")}`);\n    }\n  }\n\n  /**\n   * Set up event listeners for UI interactions\n   * @private\n   */\n  setupEventListeners() {\n    // Handle form submissions\n    this.form.addEventListener(\"submit\", (e) => {\n      e.preventDefault();\n      const message = this.input.value.trim();\n      if (message) {\n        // Emit a 'userMessage' event. The ChatbotCore will handle the logic and respond.\n        this.eventBus.emit(\"userMessage\", message);\n        this.input.value = \"\";\n      }\n    });\n\n    // Listen for chatbot events and update the UI accordingly\n    this.eventBus.on(\"messageReceived\", ({ content, metadata, isStreamed }) => {\n      console.log(\n        \"UI received messageReceived event:\",\n        content,\n        metadata,\n        isStreamed\n      );\n      this.handleAssistantMessage(content, metadata, isStreamed);\n    });\n\n    // Listen for partial and final messages\n    this.eventBus.on(\"partialMessage\", ({ content, isStreamed }) => {\n      this.handlePartialMessage(content, isStreamed);\n    });\n\n    this.eventBus.on(\"finalMessage\", ({ content, isStreamed }) => {\n      this.handleFinalMessage(content, isStreamed);\n    });\n\n    this.eventBus.on(\"typing\", ({ isTyping }) => {\n      if (isTyping) {\n        this.showTypingIndicator();\n      } else {\n        this.hideTypingIndicator();\n      }\n    });\n\n    this.eventBus.on(\"error\", ({ message }) => {\n      this.displayError(message);\n    });\n\n    this.eventBus.on(\"choicePresented\", ({ buttons }) => {\n      this.addButtons(buttons);\n    });\n\n    this.eventBus.on(\"carouselPresented\", ({ items }) => {\n      this.addCarousel(items);\n    });\n\n    // Reset current assistant message on end\n    this.eventBus.on(\"end\", () => {\n      this.currentAssistantMessage = null;\n      this.accumulatedContent = \"\";\n    });\n  }\n\n  /**\n   * Handle assistant messages with markdown support\n   * @private\n   * @param {string} content - The raw markdown message content\n   * @param {Object} metadata - Optional metadata\n   * @param {boolean} isStreamed - Indicates if the message is streamed\n   */\n  handleAssistantMessage(content, metadata, isStreamed) {\n    // Determine if the message is loaded from history\n    const isFromHistory = metadata && metadata.fromHistory;\n    const animate = !isStreamed && !isFromHistory;\n    const animationSpeed = isFromHistory ? 10 : undefined; // Faster for deterministic messages\n\n    // Create the message component with appropriate animation settings\n    const message = this.createMessage(\n      \"assistant\",\n      content,\n      metadata,\n      animate,\n      animationSpeed,\n      isStreamed\n    );\n    this.messageContainer.appendChild(message);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Handle partial assistant messages (streamed content)\n   * @private\n   * @param {string} content - Partial message content\n   * @param {boolean} isStreamed - Indicates if the message is streamed\n   */\n  handlePartialMessage(content, isStreamed) {\n    this.accumulatedContent += content;\n\n    // Check for sentence-ending punctuation\n    const sentenceEndRegex = /([.!?;]\\s)|(\\n)/;\n    const match = this.accumulatedContent.match(sentenceEndRegex);\n\n    if (match) {\n      const sentenceEndIndex = match.index + match[0].length;\n      const completeSentence = this.accumulatedContent\n        .slice(0, sentenceEndIndex)\n        .trim();\n      const remaining = this.accumulatedContent.slice(sentenceEndIndex).trim();\n\n      if (this.currentAssistantMessage) {\n        // Append complete sentence to the current message\n        this.currentAssistantMessage.appendContent(completeSentence);\n      } else {\n        // Create a new assistant message component with animation if not streamed\n        this.currentAssistantMessage = this.createMessage(\n          \"assistant\",\n          completeSentence,\n          null,\n          !isStreamed, // animate only if not streamed\n          undefined, // default animation speed\n          isStreamed\n        );\n        this.messageContainer.appendChild(this.currentAssistantMessage);\n      }\n\n      this.accumulatedContent = remaining;\n      this.scrollToBottom();\n    } else {\n      // No sentence boundary yet, append as is with animation if not streamed\n      if (this.currentAssistantMessage) {\n        this.currentAssistantMessage.appendContent(content);\n      } else {\n        this.currentAssistantMessage = this.createMessage(\n          \"assistant\",\n          content,\n          null,\n          !isStreamed, // animate only if not streamed\n          undefined, // default animation speed\n          isStreamed\n        );\n        this.messageContainer.appendChild(this.currentAssistantMessage);\n      }\n      this.scrollToBottom();\n    }\n  }\n\n  /**\n   * Handle final assistant message (complete message)\n   * @private\n   * @param {string} fullContent - The complete message content\n   * @param {boolean} isStreamed - Indicates if the message is streamed\n   */\n  handleFinalMessage(fullContent, isStreamed) {\n    if (this.currentAssistantMessage) {\n      // Append the remaining content\n      this.currentAssistantMessage.appendContent(fullContent);\n      this.currentAssistantMessage = null;\n      this.accumulatedContent = \"\";\n      this.scrollToBottom();\n    } else {\n      // In case finalMessage is received without a partial message\n      const message = this.createMessage(\n        \"assistant\",\n        fullContent,\n        null,\n        !isStreamed, // animate only if not streamed\n        undefined,\n        isStreamed\n      );\n      this.messageContainer.appendChild(message);\n      this.scrollToBottom();\n    }\n  }\n  /**\n   * Create a message component\n   * @private\n   * @param {string} sender - The sender of the message ('user' or 'assistant')\n   * @param {string} content - The raw markdown message content\n   * @param {Object} metadata - Optional metadata for the message\n   * @param {boolean} animate - Whether to animate the message\n   * @param {number} [animationSpeed] - Optional animation speed in ms per character\n   * @param {boolean} isStreamed - Indicates if the message is streamed\n   * @returns {MessageComponent} The created message component\n   */\n  createMessage(\n    sender,\n    content,\n    metadata = null,\n    animate = true,\n    animationSpeed,\n    isStreamed = false\n  ) {\n    const message = document.createElement(\"message-component\");\n    message.eventBus = this.eventBus;\n    message.setAttribute(\"sender\", sender);\n    message.setAttribute(\"content\", content); // Set initial content\n\n    if (isStreamed) {\n      message.setAttribute(\"streaming\", \"\"); // Add the streaming attribute\n    }\n\n    if (metadata) {\n      message.setAttribute(\"metadata\", JSON.stringify(metadata));\n    }\n\n    // Set data attributes for animation\n    if (!animate) {\n      message.setAttribute(\"data-animate\", \"false\");\n    }\n\n    if (animationSpeed) {\n      message.setAttribute(\"data-animation-speed\", animationSpeed.toString());\n    }\n\n    return message;\n  }\n\n  /**\n   * Add a message to the chat using the message-component\n   * @public\n   * @param {string} sender - The sender of the message ('user' or 'assistant')\n   * @param {string} content - The raw markdown message content\n   * @param {Object} metadata - Optional metadata for the message\n   * @param {boolean} fromHistory - Indicates if the message is loaded from history\n   * @param {boolean} isStreamed - Indicates if the message is streamed via completion events\n   * @param {number} [animationSpeed] - Optional animation speed in ms per character\n   */\n  addMessage(\n    sender,\n    content,\n    metadata = null,\n    fromHistory = false,\n    isStreamed = false,\n    animationSpeed = undefined\n  ) {\n    console.log(\n      `addMessage called with sender=${sender}, content=${content}, metadata=`,\n      metadata,\n      `, fromHistory=${fromHistory}, isStreamed=${isStreamed}, animationSpeed=${animationSpeed}`\n    );\n\n    if (sender === \"assistant\") {\n      // Determine if the message is streamed\n      const animate = !isStreamed && !fromHistory;\n      const speed = isStreamed\n        ? undefined // No animation\n        : fromHistory\n        ? 10\n        : animationSpeed;\n\n      const message = this.createMessage(\n        \"assistant\",\n        content,\n        metadata,\n        animate,\n        speed,\n        isStreamed\n      );\n      this.messageContainer.appendChild(message);\n\n      if (isStreamed) {\n        // For streamed messages, append content directly\n        message.appendContent(content);\n      }\n\n      this.scrollToBottom();\n    } else if (sender === \"user\") {\n      // For user messages, determine if it's from history or a new message\n      const animate = !fromHistory;\n      const speed = animationSpeed || (fromHistory ? 10 : undefined);\n\n      const message = this.createMessage(\n        sender,\n        content,\n        metadata,\n        animate,\n        speed,\n        isStreamed\n      );\n      this.messageContainer.appendChild(message);\n      this.scrollToBottom();\n    }\n  }\n\n  handlePartialMessage(content, isStreamed) {\n    // If there is no current assistant message, create one\n    if (!this.currentAssistantMessage) {\n      this.currentAssistantMessage = this.createMessage(\n        \"assistant\",\n        \"\", // Start with empty content\n        null,\n        false, // Do not animate character by character\n        undefined,\n        true // isStreamed\n      );\n      this.messageContainer.appendChild(this.currentAssistantMessage);\n    }\n    this.currentAssistantMessage.appendContent(content);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Handle final assistant message (complete message)\n   * @private\n   * @param {string} fullContent - The complete message content\n   * @param {boolean} isStreamed - Indicates if the message is streamed\n   */\n  handleFinalMessage(fullContent, isStreamed) {\n    console.log(\"handleFinalMessage called\", { fullContent, isStreamed });\n    if (this.currentAssistantMessage) {\n      this.currentAssistantMessage.finalizeContentAndAnimate();\n      this.currentAssistantMessage = null;\n      this.accumulatedContent = \"\";\n    } else {\n      console.warn(\n        \"handleFinalMessage called but currentAssistantMessage is null\",\n        { fullContent, isStreamed }\n      );\n      // Fallback: Create and add the message without animation\n      const message = this.createMessage(\n        \"assistant\",\n        fullContent,\n        null,\n        false, // No character animation for fallback\n        undefined,\n        isStreamed\n      );\n      this.messageContainer.appendChild(message);\n    }\n    this.scrollToBottom();\n  }\n\n  /**\n   * Add interactive buttons to the chat using button-component\n   * @public\n   * @param {Array} buttons - Array of button data\n   * @param {boolean} fromHistory - Indicates if the buttons are loaded from history\n   */\n  addButtons(buttons, fromHistory = false) {\n    if (!Array.isArray(buttons)) {\n      console.error(\"Invalid buttons data:\", buttons);\n      return;\n    }\n\n    // Use <button-component> for each button\n    const buttonGroup = document.createElement(\"div\");\n    buttonGroup.className = \"button-group\";\n\n    buttons.forEach((buttonData) => {\n      const button = document.createElement(\"button-component\");\n      button.eventBus = this.eventBus;\n      button.setAttribute(\"label\", buttonData.name);\n      button.setAttribute(\"payload\", JSON.stringify(buttonData.request));\n      buttonGroup.appendChild(button);\n    });\n\n    this.messageContainer.appendChild(buttonGroup);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Add a carousel to the chat using carousel-component\n   * @public\n   * @param {Array} items - Array of carousel items\n   * @param {boolean} fromHistory - Indicates if the carousel is loaded from history\n   */\n  addCarousel(items, fromHistory = false) {\n    if (!Array.isArray(items)) {\n      console.error(\"Invalid carousel items:\", items);\n      return;\n    }\n\n    // Use <carousel-component> with a data-carousel attribute\n    const carousel = document.createElement(\"carousel-component\");\n    carousel.eventBus = this.eventBus;\n    carousel.setAttribute(\"data-carousel\", JSON.stringify({ cards: items }));\n    this.messageContainer.appendChild(carousel);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Show the typing indicator\n   * @public\n   */\n  showTypingIndicator() {\n    if (this.typingIndicator) {\n      this.typingIndicator.style.display = \"flex\";\n      this.scrollToBottom();\n    }\n  }\n\n  /**\n   * Hide the typing indicator\n   * @public\n   */\n  hideTypingIndicator() {\n    if (this.typingIndicator) {\n      this.typingIndicator.style.display = \"none\";\n    }\n  }\n\n  /**\n   * Display an error message\n   * @public\n   * @param {string} message - The error message to display\n   */\n  displayError(message) {\n    // For errors, create a div with the error message\n    const errorDiv = document.createElement(\"div\");\n    errorDiv.classList.add(\"error-message\");\n    errorDiv.textContent = message;\n    this.messageContainer.appendChild(errorDiv);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Remove all interactive elements\n   * @public\n   */\n  removeInteractiveElements() {\n    // Remove all custom components and groups of interactive elements\n    const elements = this.messageContainer.querySelectorAll(\n      \"button-component, carousel-component, .button-group\"\n    );\n    elements.forEach((element) => element.remove());\n  }\n\n  /**\n   * Scroll the message container to the bottom\n   * @private\n   */\n  scrollToBottom() {\n    this.messageContainer.scrollTop = this.messageContainer.scrollHeight;\n  }\n\n  /**\n   * Clean up resources\n   * @public\n   */\n  destroy() {\n    if (this.abortController) {\n      this.abortController.abort();\n    }\n    this.eventBus.removeAllListeners();\n  }\n}\n\nexport default ChatbotUI;\n"],"names":["ChatbotUI","config","messageContainers","forms","inputs","typingIndicators","_a","missing","message","content","metadata","isStreamed","isTyping","buttons","items","isFromHistory","animate","animationSpeed","sentenceEndRegex","match","sentenceEndIndex","completeSentence","remaining","fullContent","sender","fromHistory","speed","buttonGroup","buttonData","button","carousel","errorDiv","element"],"mappings":"8DASA,MAAMA,CAAU,CAOd,YAAYC,EAAQ,CAClB,GAAI,CAACA,EAAO,UACV,MAAM,IAAI,MAAM,wCAAwC,EAE1D,GAAI,CAACA,EAAO,SACV,MAAM,IAAI,MAAM,iCAAiC,EAGnD,KAAK,UAAYA,EAAO,UACxB,KAAK,SAAWA,EAAO,SACvB,KAAK,KAAOA,EAAO,KAEnB,KAAK,wBAA0B,KAC/B,KAAK,mBAAqB,GAE1B,KAAK,gBAAe,EACpB,KAAK,oBAAmB,CACzB,CAMD,iBAAkB,OAChB,MAAMC,EACJ,KAAK,UAAU,iBAAiB,oBAAoB,EACtD,KAAK,iBAAmBA,EAAkB,CAAC,EAC3C,QAAQ,IAAI,2BAA4B,CAAC,CAAC,KAAK,gBAAgB,EAE/D,MAAMC,EAAQ,KAAK,UAAU,iBAAiB,YAAY,EAC1D,KAAK,KAAOA,EAAM,CAAC,EACnB,QAAQ,IAAI,mBAAoB,CAAC,CAAC,KAAK,IAAI,EAE3C,MAAMC,EAAS,KAAK,UAAU,iBAAiB,gBAAgB,EAC/D,KAAK,MAAQA,EAAO,CAAC,EACrB,QAAQ,IAAI,oBAAqB,CAAC,CAAC,KAAK,KAAK,EAE7C,MAAMC,EAAmB,KAAK,UAAU,iBAAiB,cAAc,EASvE,GARA,KAAK,gBAAkBA,EAAiB,CAAC,EACzC,QAAQ,IAAI,0BAA2B,CAAC,CAAC,KAAK,eAAe,EAE7D,KAAK,YAAaC,EAAA,KAAK,kBAAL,YAAAA,EAAsB,cAAc,gBACtD,QAAQ,IAAI,qBAAsB,CAAC,CAAC,KAAK,UAAU,EAEnD,QAAQ,IAAI,kBAAmB,KAAK,UAAU,SAAS,EAEnD,CAAC,KAAK,kBAAoB,CAAC,KAAK,MAAQ,CAAC,KAAK,MAAO,CACvD,MAAMC,EAAU,CAAA,EAChB,MAAK,KAAK,kBAAkBA,EAAQ,KAAK,mBAAmB,EACvD,KAAK,MAAMA,EAAQ,KAAK,WAAW,EACnC,KAAK,OAAOA,EAAQ,KAAK,eAAe,EACvC,IAAI,MAAM,mCAAmCA,EAAQ,KAAK,IAAI,CAAC,EAAE,CACxE,CACF,CAMD,qBAAsB,CAEpB,KAAK,KAAK,iBAAiB,SAAW,GAAM,CAC1C,EAAE,eAAc,EAChB,MAAMC,EAAU,KAAK,MAAM,MAAM,KAAI,EACjCA,IAEF,KAAK,SAAS,KAAK,cAAeA,CAAO,EACzC,KAAK,MAAM,MAAQ,GAE3B,CAAK,EAGD,KAAK,SAAS,GAAG,kBAAmB,CAAC,CAAE,QAAAC,EAAS,SAAAC,EAAU,WAAAC,KAAiB,CACzE,QAAQ,IACN,qCACAF,EACAC,EACAC,CACR,EACM,KAAK,uBAAuBF,EAASC,EAAUC,CAAU,CAC/D,CAAK,EAGD,KAAK,SAAS,GAAG,iBAAkB,CAAC,CAAE,QAAAF,EAAS,WAAAE,KAAiB,CAC9D,KAAK,qBAAqBF,EAASE,CAAU,CACnD,CAAK,EAED,KAAK,SAAS,GAAG,eAAgB,CAAC,CAAE,QAAAF,EAAS,WAAAE,KAAiB,CAC5D,KAAK,mBAAmBF,EAASE,CAAU,CACjD,CAAK,EAED,KAAK,SAAS,GAAG,SAAU,CAAC,CAAE,SAAAC,CAAQ,IAAO,CACvCA,EACF,KAAK,oBAAmB,EAExB,KAAK,oBAAmB,CAEhC,CAAK,EAED,KAAK,SAAS,GAAG,QAAS,CAAC,CAAE,QAAAJ,CAAO,IAAO,CACzC,KAAK,aAAaA,CAAO,CAC/B,CAAK,EAED,KAAK,SAAS,GAAG,kBAAmB,CAAC,CAAE,QAAAK,CAAO,IAAO,CACnD,KAAK,WAAWA,CAAO,CAC7B,CAAK,EAED,KAAK,SAAS,GAAG,oBAAqB,CAAC,CAAE,MAAAC,CAAK,IAAO,CACnD,KAAK,YAAYA,CAAK,CAC5B,CAAK,EAGD,KAAK,SAAS,GAAG,MAAO,IAAM,CAC5B,KAAK,wBAA0B,KAC/B,KAAK,mBAAqB,EAChC,CAAK,CACF,CASD,uBAAuBL,EAASC,EAAUC,EAAY,CAEpD,MAAMI,EAAgBL,GAAYA,EAAS,YACrCM,EAAU,CAACL,GAAc,CAACI,EAC1BE,EAAiBF,EAAgB,GAAK,OAGtCP,EAAU,KAAK,cACnB,YACAC,EACAC,EACAM,EACAC,EACAN,CACN,EACI,KAAK,iBAAiB,YAAYH,CAAO,EACzC,KAAK,eAAc,CACpB,CAQD,qBAAqBC,EAASE,EAAY,CACxC,KAAK,oBAAsBF,EAG3B,MAAMS,EAAmB,kBACnBC,EAAQ,KAAK,mBAAmB,MAAMD,CAAgB,EAE5D,GAAIC,EAAO,CACT,MAAMC,EAAmBD,EAAM,MAAQA,EAAM,CAAC,EAAE,OAC1CE,EAAmB,KAAK,mBAC3B,MAAM,EAAGD,CAAgB,EACzB,OACGE,EAAY,KAAK,mBAAmB,MAAMF,CAAgB,EAAE,OAE9D,KAAK,wBAEP,KAAK,wBAAwB,cAAcC,CAAgB,GAG3D,KAAK,wBAA0B,KAAK,cAClC,YACAA,EACA,KACA,CAACV,EACD,OACAA,CACV,EACQ,KAAK,iBAAiB,YAAY,KAAK,uBAAuB,GAGhE,KAAK,mBAAqBW,EAC1B,KAAK,eAAc,CACzB,MAEU,KAAK,wBACP,KAAK,wBAAwB,cAAcb,CAAO,GAElD,KAAK,wBAA0B,KAAK,cAClC,YACAA,EACA,KACA,CAACE,EACD,OACAA,CACV,EACQ,KAAK,iBAAiB,YAAY,KAAK,uBAAuB,GAEhE,KAAK,eAAc,CAEtB,CAQD,mBAAmBY,EAAaZ,EAAY,CAC1C,GAAI,KAAK,wBAEP,KAAK,wBAAwB,cAAcY,CAAW,EACtD,KAAK,wBAA0B,KAC/B,KAAK,mBAAqB,GAC1B,KAAK,eAAc,MACd,CAEL,MAAMf,EAAU,KAAK,cACnB,YACAe,EACA,KACA,CAACZ,EACD,OACAA,CACR,EACM,KAAK,iBAAiB,YAAYH,CAAO,EACzC,KAAK,eAAc,CACpB,CACF,CAYD,cACEgB,EACAf,EACAC,EAAW,KACXM,EAAU,GACVC,EACAN,EAAa,GACb,CACA,MAAMH,EAAU,SAAS,cAAc,mBAAmB,EAC1D,OAAAA,EAAQ,SAAW,KAAK,SACxBA,EAAQ,aAAa,SAAUgB,CAAM,EACrChB,EAAQ,aAAa,UAAWC,CAAO,EAEnCE,GACFH,EAAQ,aAAa,YAAa,EAAE,EAGlCE,GACFF,EAAQ,aAAa,WAAY,KAAK,UAAUE,CAAQ,CAAC,EAItDM,GACHR,EAAQ,aAAa,eAAgB,OAAO,EAG1CS,GACFT,EAAQ,aAAa,uBAAwBS,EAAe,SAAU,CAAA,EAGjET,CACR,CAYD,WACEgB,EACAf,EACAC,EAAW,KACXe,EAAc,GACdd,EAAa,GACbM,EAAiB,OACjB,CAOA,GANA,QAAQ,IACN,iCAAiCO,CAAM,aAAaf,CAAO,cAC3DC,EACA,iBAAiBe,CAAW,gBAAgBd,CAAU,oBAAoBM,CAAc,EAC9F,EAEQO,IAAW,YAAa,CAE1B,MAAMR,EAAU,CAACL,GAAc,CAACc,EAC1BC,EAAQf,EACV,OACAc,EACA,GACAR,EAEET,EAAU,KAAK,cACnB,YACAC,EACAC,EACAM,EACAU,EACAf,CACR,EACM,KAAK,iBAAiB,YAAYH,CAAO,EAErCG,GAEFH,EAAQ,cAAcC,CAAO,EAG/B,KAAK,eAAc,CACzB,SAAee,IAAW,OAAQ,CAE5B,MAAMR,EAAU,CAACS,EACXC,EAAQT,IAAmBQ,EAAc,GAAK,QAE9CjB,EAAU,KAAK,cACnBgB,EACAf,EACAC,EACAM,EACAU,EACAf,CACR,EACM,KAAK,iBAAiB,YAAYH,CAAO,EACzC,KAAK,eAAc,CACpB,CACF,CAED,qBAAqBC,EAASE,EAAY,CAEnC,KAAK,0BACR,KAAK,wBAA0B,KAAK,cAClC,YACA,GACA,KACA,GACA,OACA,EACR,EACM,KAAK,iBAAiB,YAAY,KAAK,uBAAuB,GAEhE,KAAK,wBAAwB,cAAcF,CAAO,EAClD,KAAK,eAAc,CACpB,CAQD,mBAAmBc,EAAaZ,EAAY,CAE1C,GADA,QAAQ,IAAI,4BAA6B,CAAE,YAAAY,EAAa,WAAAZ,CAAY,CAAA,EAChE,KAAK,wBACP,KAAK,wBAAwB,4BAC7B,KAAK,wBAA0B,KAC/B,KAAK,mBAAqB,OACrB,CACL,QAAQ,KACN,gEACA,CAAE,YAAAY,EAAa,WAAAZ,CAAY,CACnC,EAEM,MAAMH,EAAU,KAAK,cACnB,YACAe,EACA,KACA,GACA,OACAZ,CACR,EACM,KAAK,iBAAiB,YAAYH,CAAO,CAC1C,CACD,KAAK,eAAc,CACpB,CAQD,WAAWK,EAASY,EAAc,GAAO,CACvC,GAAI,CAAC,MAAM,QAAQZ,CAAO,EAAG,CAC3B,QAAQ,MAAM,wBAAyBA,CAAO,EAC9C,MACD,CAGD,MAAMc,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,UAAY,eAExBd,EAAQ,QAASe,GAAe,CAC9B,MAAMC,EAAS,SAAS,cAAc,kBAAkB,EACxDA,EAAO,SAAW,KAAK,SACvBA,EAAO,aAAa,QAASD,EAAW,IAAI,EAC5CC,EAAO,aAAa,UAAW,KAAK,UAAUD,EAAW,OAAO,CAAC,EACjED,EAAY,YAAYE,CAAM,CACpC,CAAK,EAED,KAAK,iBAAiB,YAAYF,CAAW,EAC7C,KAAK,eAAc,CACpB,CAQD,YAAYb,EAAOW,EAAc,GAAO,CACtC,GAAI,CAAC,MAAM,QAAQX,CAAK,EAAG,CACzB,QAAQ,MAAM,0BAA2BA,CAAK,EAC9C,MACD,CAGD,MAAMgB,EAAW,SAAS,cAAc,oBAAoB,EAC5DA,EAAS,SAAW,KAAK,SACzBA,EAAS,aAAa,gBAAiB,KAAK,UAAU,CAAE,MAAOhB,CAAO,CAAA,CAAC,EACvE,KAAK,iBAAiB,YAAYgB,CAAQ,EAC1C,KAAK,eAAc,CACpB,CAMD,qBAAsB,CAChB,KAAK,kBACP,KAAK,gBAAgB,MAAM,QAAU,OACrC,KAAK,eAAc,EAEtB,CAMD,qBAAsB,CAChB,KAAK,kBACP,KAAK,gBAAgB,MAAM,QAAU,OAExC,CAOD,aAAatB,EAAS,CAEpB,MAAMuB,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,UAAU,IAAI,eAAe,EACtCA,EAAS,YAAcvB,EACvB,KAAK,iBAAiB,YAAYuB,CAAQ,EAC1C,KAAK,eAAc,CACpB,CAMD,2BAA4B,CAET,KAAK,iBAAiB,iBACrC,qDACN,EACa,QAASC,GAAYA,EAAQ,OAAQ,CAAA,CAC/C,CAMD,gBAAiB,CACf,KAAK,iBAAiB,UAAY,KAAK,iBAAiB,YACzD,CAMD,SAAU,CACJ,KAAK,iBACP,KAAK,gBAAgB,QAEvB,KAAK,SAAS,oBACf,CACH"}