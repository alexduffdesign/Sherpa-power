{"version":3,"file":"base-chatbot-ui.BdMScNre.js","sources":["../frontend/baseChatbot/base-chatbot-ui.js"],"sourcesContent":["// /assets/scripts/chatbot/core/base-chatbot-ui.js\n\nimport EventEmitter from \"eventemitter3\";\nimport { animateText, animateHTMLContent } from \"../utils/animation-util.js\";\nimport { parseMarkdown } from \"../utils/markdown-util.js\";\n\n/**\n * ChatbotUI Class\n * Handles base UI functionality for chatbots with markdown and streaming support\n */\nclass ChatbotUI {\n  /**\n   * @param {Object} config - Configuration object\n   * @param {HTMLElement} config.container - The container element for the chatbot\n   * @param {EventEmitter} config.eventBus - Event bus instance\n   * @param {string} config.type - Type of chatbot ('main' or 'section')\n   */\n  constructor(config) {\n    if (!config.container) {\n      throw new Error(\"ChatbotUI requires a container element\");\n    }\n    if (!config.eventBus) {\n      throw new Error(\"ChatbotUI requires an event bus\");\n    }\n\n    this.container = config.container;\n    this.eventBus = config.eventBus;\n    this.type = config.type;\n\n    this.currentAssistantMessage = null; // Track the current assistant message\n\n    this.setupUIElements();\n    this.setupEventListeners();\n  }\n\n  /**\n   * Set up references to UI elements\n   * @private\n   */\n  setupUIElements() {\n    const messageContainers =\n      this.container.querySelectorAll(\".message-container\");\n    this.messageContainer = messageContainers[0];\n\n    const forms = this.container.querySelectorAll(\".chat-form\");\n    this.form = forms[0];\n\n    const inputs = this.container.querySelectorAll(\".chatbot-input\");\n    this.input = inputs[0];\n\n    const typingIndicators = this.container.querySelectorAll(\".chat-typing\");\n    this.typingIndicator = typingIndicators[0];\n\n    this.typingText = this.typingIndicator?.querySelector(\".typing-text\");\n\n    this.chatMessages = this.container.querySelector(\".chat-messages\");\n\n    console.log(\"Container HTML:\", this.container.innerHTML);\n\n    if (!this.messageContainer || !this.form || !this.input) {\n      const missing = [];\n      if (!this.messageContainer) missing.push(\"message-container\");\n      if (!this.form) missing.push(\"chat-form\");\n      if (!this.input) missing.push(\"chatbot-input\");\n      throw new Error(`Required UI elements not found: ${missing.join(\", \")}`);\n    }\n  }\n\n  /**\n   * Set up event listeners for UI interactions\n   * @private\n   */\n  setupEventListeners() {\n    // Handle form submissions\n    this.form.addEventListener(\"submit\", (e) => {\n      e.preventDefault();\n      const message = this.input.value.trim();\n      if (message) {\n        this.removeInteractiveElements();\n        this.showTypingIndicator(\"Sherpa Guide Thinking...\");\n\n        this.addMessage(\"user\", message, null, false);\n        this.eventBus.emit(\"userMessage\", message);\n        this.input.value = \"\";\n      }\n    });\n\n    this.eventBus.on(\"typing\", ({ isTyping, message }) => {\n      if (isTyping) {\n        this.showTypingIndicator(message);\n      } else {\n        this.hideTypingIndicator();\n      }\n    });\n\n    this.eventBus.on(\"waitingText\", ({ text }) => {\n      this.showTypingIndicator(text);\n    });\n\n    // Handle button clicks\n    this.eventBus.on(\"buttonClicked\", (payload) => {\n      const userMessage = payload.label || \"Button clicked\";\n      this.showTypingIndicator();\n      this.addMessage(\"user\", userMessage, null, false); // Use this directly since we're in ChatbotUI\n      this.eventBus.emit(\"sendAction\", payload.action); // Emit event for core to handle\n      this.removeInteractiveElements();\n    });\n\n    this.eventBus.on(\"assistantMessageStreamed\", ({ content }) => {\n      this.handleAssistantStreamedMessage(content);\n      console.log(\"assistnatmessageStreamed activated\", content);\n    });\n\n    this.eventBus.on(\"assistantMessageNonStreamed\", ({ content, metadata }) => {\n      this.handleAssistantNonStreamedMessage(content, metadata);\n    });\n\n    this.eventBus.on(\"error\", ({ message }) => {\n      this.displayError(message);\n    });\n\n    this.eventBus.on(\"choicePresented\", ({ buttons }) => {\n      this.addButtons(buttons);\n    });\n\n    this.eventBus.on(\"carouselPresented\", ({ items }) => {\n      this.addCarousel(items);\n    });\n\n    // Reset current assistant message on end\n    this.eventBus.on(\"end\", () => {\n      this.currentAssistantMessage = null;\n      this.hideTypingIndicator();\n    });\n\n    this.eventBus.on(\"deviceSources\", ({ sources }) => {\n      this.addDeviceSources(sources);\n    });\n  }\n\n  handleAssistantStreamedMessage(content) {\n    if (!this.currentAssistantMessage) {\n      // Create a message in streaming mode\n      this.currentAssistantMessage = this.createMessage(\n        \"assistant\",\n        \"\",\n        null,\n        false,\n        undefined,\n        true\n      );\n      this.messageContainer.appendChild(this.currentAssistantMessage);\n      // Set the initial content attribute\n      this.currentAssistantMessage.setAttribute(\"content\", content);\n      this.currentAssistantMessage.appendHTMLContent(content);\n      this.scrollToBottom();\n    } else {\n      // Append to the existing message\n      this.currentAssistantMessage.appendHTMLContent(content);\n    }\n  }\n\n  handleAssistantNonStreamedMessage(content, metadata) {\n    const parsedContent = parseMarkdown(content);\n\n    const message = this.createMessage(\n      \"assistant\",\n      parsedContent,\n      metadata,\n      true,\n      4,\n      false\n    );\n\n    this.messageContainer.appendChild(message);\n    this.hideTypingIndicator();\n    this.scrollToBottom();\n  }\n\n  /**\n   * Create a message component\n   * @private\n   * @param {string} sender - The sender of the message ('user' or 'assistant')\n   * @param {string} content - The raw markdown message content or HTML segments\n   * @param {Object} metadata - Optional metadata for the message\n   * @param {boolean} animate - Whether to animate the message\n   * @param {number} [animationSpeed] - Optional animation speed in ms per character\n   * @param {boolean} isStreamed - Indicates if the message is streamed\n   * @returns {MessageComponent} The created message component\n   */\n  createMessage(\n    sender,\n    content,\n    metadata = null,\n    animate = true,\n    animationSpeed,\n    isStreamed = false\n  ) {\n    const message = document.createElement(\"message-component\");\n    message.eventBus = this.eventBus;\n    message.setAttribute(\"sender\", sender);\n    message.setAttribute(\"content\", content); // Set initial content\n\n    if (isStreamed) {\n      message.setAttribute(\"streaming\", \"\"); // Add the streaming attribute\n    }\n\n    if (metadata) {\n      message.setAttribute(\"metadata\", JSON.stringify(metadata));\n    }\n\n    // Set data attributes for animation\n    if (!animate) {\n      message.setAttribute(\"data-animate\", \"false\");\n    }\n\n    if (animationSpeed) {\n      message.setAttribute(\"data-animation-speed\", animationSpeed.toString());\n    }\n\n    return message;\n  }\n\n  /**\n   * Add interactive buttons to the chat using button-component\n   * @public\n   * @param {Array} buttons - Array of button data\n   * @param {boolean} fromHistory - Indicates if the buttons are loaded from history\n   */\n  addButtons(buttons, fromHistory = false) {\n    if (!Array.isArray(buttons)) {\n      console.error(\"Invalid buttons data:\", buttons);\n      return;\n    }\n\n    // Use <button-component> for each button\n    const buttonGroup = document.createElement(\"div\");\n    buttonGroup.className = \"button-group\";\n\n    buttons.forEach((buttonData) => {\n      const button = document.createElement(\"button-component\");\n      button.eventBus = this.eventBus;\n      button.setAttribute(\"label\", buttonData.name);\n      button.setAttribute(\"payload\", JSON.stringify(buttonData.request));\n      buttonGroup.appendChild(button);\n    });\n\n    this.messageContainer.appendChild(buttonGroup);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Add a carousel to the chat using carousel-component\n   * @public\n   * @param {Array} items - Array of carousel items\n   * @param {boolean} fromHistory - Indicates if the carousel is loaded from history\n   */\n  addCarousel(items, fromHistory = false) {\n    if (!Array.isArray(items)) {\n      console.error(\"Invalid carousel items:\", items);\n      return;\n    }\n\n    // Use <carousel-component> with a data-carousel attribute\n    const carousel = document.createElement(\"carousel-component\");\n    carousel.eventBus = this.eventBus;\n    carousel.setAttribute(\"data-carousel\", JSON.stringify({ cards: items }));\n    this.messageContainer.appendChild(carousel);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Show the typing indicator\n   * @public\n   */\n  showTypingIndicator(message = \"Sherpa Guide Thinking\") {\n    if (this.typingIndicator) {\n      this.typingIndicator.style.display = \"flex\";\n\n      // Only update text content if message is provided and typingText exists\n      if (message && this.typingText) {\n        this.typingText.textContent = message;\n      }\n\n      this.scrollToBottom();\n    }\n  }\n\n  /**\n   * Hide the typing indicator\n   * @public\n   */\n  hideTypingIndicator() {\n    if (this.typingIndicator) {\n      this.typingIndicator.style.display = \"none\";\n    }\n  }\n\n  /**\n   * Display an error message\n   * @public\n   * @param {string} message - The error message to display\n   */\n  displayError(message) {\n    // For errors, create a div with the error message\n    const errorDiv = document.createElement(\"div\");\n    errorDiv.classList.add(\"error-message\");\n    errorDiv.textContent = message;\n    this.messageContainer.appendChild(errorDiv);\n    this.scrollToBottom();\n  }\n\n  /**\n   * Remove all interactive elements\n   * @public\n   */\n  removeInteractiveElements() {\n    // Remove all custom components and groups of interactive elements\n    const elements = this.messageContainer.querySelectorAll(\n      \"button-component, carousel-component, .button-group\"\n    );\n    elements.forEach((element) => element.remove());\n  }\n\n  /**\n   * Scroll the message container to the bottom\n   * @private\n   */\n  scrollToBottom() {\n    if (this.type === \"main\") {\n      // For main chatbot, scroll the drawer body\n      const drawerBody = this.container\n        .closest(\"custom-drawer\")\n        ?.shadowRoot?.querySelector('[part=\"body\"]');\n      if (drawerBody) {\n        drawerBody.scrollTop = drawerBody.scrollHeight;\n      }\n    } else {\n      // For other chatbot types, scroll the message container\n      this.chatMessages.scrollTop = this.chatMessages.scrollHeight;\n    }\n  }\n\n  /**\n   * Clean up resources\n   * @public\n   */\n  destroy() {\n    if (this.abortController) {\n      this.abortController.abort();\n    }\n    this.eventBus.removeAllListeners();\n  }\n\n  /**\n   * Add a user message to the UI\n   * @public\n   * @param {string} sender - The sender ('user')\n   * @param {string} message - The message content\n   * @param {Object} metadata - Optional metadata\n   * @param {boolean} fromHistory - Whether message is from history\n   * @param {boolean} isStreamed - Whether message is part of streaming response\n   */\n  addMessage(\n    sender,\n    message,\n    metadata = null,\n    fromHistory = false,\n    isStreamed = false\n  ) {\n    const parsedMessage =\n      sender === \"assistant\" && !isStreamed ? parseMarkdown(message) : message;\n\n    const shouldAnimate = sender === \"assistant\" && !fromHistory;\n    const animationSpeed = fromHistory ? 2 : undefined; // Adjusted speed here too\n\n    const messageComponent = this.createMessage(\n      sender,\n      parsedMessage,\n      metadata,\n      shouldAnimate,\n      animationSpeed,\n      isStreamed\n    );\n\n    this.messageContainer.appendChild(messageComponent);\n    this.scrollToBottom();\n  }\n\n  addDeviceSources(sources) {\n    const sourcesContainer = document.createElement(\"div\");\n    sourcesContainer.className = \"device-sources\";\n\n    const title = document.createElement(\"h4\");\n    title.className = \"device-sources__title\";\n    title.textContent = \"Reference Sources\";\n    sourcesContainer.appendChild(title);\n\n    sources.forEach((item) => {\n      const deviceSection = document.createElement(\"div\");\n      deviceSection.className = \"device-sources__section\";\n\n      const deviceName = document.createElement(\"div\");\n      deviceName.className = \"device-sources__device\";\n      deviceName.textContent =\n        item.name.charAt(0).toUpperCase() + item.name.slice(1);\n      deviceSection.appendChild(deviceName);\n\n      const referencesList = document.createElement(\"ul\");\n      referencesList.className = \"device-sources__list\";\n\n      item.sources.forEach((ref) => {\n        const refItem = document.createElement(\"li\");\n        const refLink = document.createElement(\"a\");\n        refLink.href = ref;\n        refLink.target = \"_blank\";\n        refLink.rel = \"noopener noreferrer\";\n        refLink.textContent = new URL(ref).hostname;\n        refItem.appendChild(refLink);\n        referencesList.appendChild(refItem);\n      });\n\n      deviceSection.appendChild(referencesList);\n      sourcesContainer.appendChild(deviceSection);\n    });\n\n    this.messageContainer.appendChild(sourcesContainer);\n    this.scrollToBottom();\n  }\n}\n\nexport default ChatbotUI;\n"],"names":["ChatbotUI","config","messageContainers","forms","inputs","typingIndicators","_a","missing","message","isTyping","text","payload","userMessage","content","metadata","buttons","items","sources","parsedContent","parseMarkdown","sender","animate","animationSpeed","isStreamed","fromHistory","buttonGroup","buttonData","button","carousel","errorDiv","element","drawerBody","_b","parsedMessage","shouldAnimate","messageComponent","sourcesContainer","title","item","deviceSection","deviceName","referencesList","ref","refItem","refLink"],"mappings":"6EAUA,MAAMA,CAAU,CAOd,YAAYC,EAAQ,CAClB,GAAI,CAACA,EAAO,UACV,MAAM,IAAI,MAAM,wCAAwC,EAE1D,GAAI,CAACA,EAAO,SACV,MAAM,IAAI,MAAM,iCAAiC,EAGnD,KAAK,UAAYA,EAAO,UACxB,KAAK,SAAWA,EAAO,SACvB,KAAK,KAAOA,EAAO,KAEnB,KAAK,wBAA0B,KAE/B,KAAK,gBAAe,EACpB,KAAK,oBAAmB,CACzB,CAMD,iBAAkB,OAChB,MAAMC,EACJ,KAAK,UAAU,iBAAiB,oBAAoB,EACtD,KAAK,iBAAmBA,EAAkB,CAAC,EAE3C,MAAMC,EAAQ,KAAK,UAAU,iBAAiB,YAAY,EAC1D,KAAK,KAAOA,EAAM,CAAC,EAEnB,MAAMC,EAAS,KAAK,UAAU,iBAAiB,gBAAgB,EAC/D,KAAK,MAAQA,EAAO,CAAC,EAErB,MAAMC,EAAmB,KAAK,UAAU,iBAAiB,cAAc,EASvE,GARA,KAAK,gBAAkBA,EAAiB,CAAC,EAEzC,KAAK,YAAaC,EAAA,KAAK,kBAAL,YAAAA,EAAsB,cAAc,gBAEtD,KAAK,aAAe,KAAK,UAAU,cAAc,gBAAgB,EAEjE,QAAQ,IAAI,kBAAmB,KAAK,UAAU,SAAS,EAEnD,CAAC,KAAK,kBAAoB,CAAC,KAAK,MAAQ,CAAC,KAAK,MAAO,CACvD,MAAMC,EAAU,CAAA,EAChB,MAAK,KAAK,kBAAkBA,EAAQ,KAAK,mBAAmB,EACvD,KAAK,MAAMA,EAAQ,KAAK,WAAW,EACnC,KAAK,OAAOA,EAAQ,KAAK,eAAe,EACvC,IAAI,MAAM,mCAAmCA,EAAQ,KAAK,IAAI,CAAC,EAAE,CACxE,CACF,CAMD,qBAAsB,CAEpB,KAAK,KAAK,iBAAiB,SAAW,GAAM,CAC1C,EAAE,eAAc,EAChB,MAAMC,EAAU,KAAK,MAAM,MAAM,KAAI,EACjCA,IACF,KAAK,0BAAyB,EAC9B,KAAK,oBAAoB,0BAA0B,EAEnD,KAAK,WAAW,OAAQA,EAAS,KAAM,EAAK,EAC5C,KAAK,SAAS,KAAK,cAAeA,CAAO,EACzC,KAAK,MAAM,MAAQ,GAE3B,CAAK,EAED,KAAK,SAAS,GAAG,SAAU,CAAC,CAAE,SAAAC,EAAU,QAAAD,KAAc,CAChDC,EACF,KAAK,oBAAoBD,CAAO,EAEhC,KAAK,oBAAmB,CAEhC,CAAK,EAED,KAAK,SAAS,GAAG,cAAe,CAAC,CAAE,KAAAE,CAAI,IAAO,CAC5C,KAAK,oBAAoBA,CAAI,CACnC,CAAK,EAGD,KAAK,SAAS,GAAG,gBAAkBC,GAAY,CAC7C,MAAMC,EAAcD,EAAQ,OAAS,iBACrC,KAAK,oBAAmB,EACxB,KAAK,WAAW,OAAQC,EAAa,KAAM,EAAK,EAChD,KAAK,SAAS,KAAK,aAAcD,EAAQ,MAAM,EAC/C,KAAK,0BAAyB,CACpC,CAAK,EAED,KAAK,SAAS,GAAG,2BAA4B,CAAC,CAAE,QAAAE,CAAO,IAAO,CAC5D,KAAK,+BAA+BA,CAAO,EAC3C,QAAQ,IAAI,qCAAsCA,CAAO,CAC/D,CAAK,EAED,KAAK,SAAS,GAAG,8BAA+B,CAAC,CAAE,QAAAA,EAAS,SAAAC,KAAe,CACzE,KAAK,kCAAkCD,EAASC,CAAQ,CAC9D,CAAK,EAED,KAAK,SAAS,GAAG,QAAS,CAAC,CAAE,QAAAN,CAAO,IAAO,CACzC,KAAK,aAAaA,CAAO,CAC/B,CAAK,EAED,KAAK,SAAS,GAAG,kBAAmB,CAAC,CAAE,QAAAO,CAAO,IAAO,CACnD,KAAK,WAAWA,CAAO,CAC7B,CAAK,EAED,KAAK,SAAS,GAAG,oBAAqB,CAAC,CAAE,MAAAC,CAAK,IAAO,CACnD,KAAK,YAAYA,CAAK,CAC5B,CAAK,EAGD,KAAK,SAAS,GAAG,MAAO,IAAM,CAC5B,KAAK,wBAA0B,KAC/B,KAAK,oBAAmB,CAC9B,CAAK,EAED,KAAK,SAAS,GAAG,gBAAiB,CAAC,CAAE,QAAAC,CAAO,IAAO,CACjD,KAAK,iBAAiBA,CAAO,CACnC,CAAK,CACF,CAED,+BAA+BJ,EAAS,CACjC,KAAK,wBAiBR,KAAK,wBAAwB,kBAAkBA,CAAO,GAftD,KAAK,wBAA0B,KAAK,cAClC,YACA,GACA,KACA,GACA,OACA,EACR,EACM,KAAK,iBAAiB,YAAY,KAAK,uBAAuB,EAE9D,KAAK,wBAAwB,aAAa,UAAWA,CAAO,EAC5D,KAAK,wBAAwB,kBAAkBA,CAAO,EACtD,KAAK,eAAc,EAKtB,CAED,kCAAkCA,EAASC,EAAU,CACnD,MAAMI,EAAgBC,EAAcN,CAAO,EAErCL,EAAU,KAAK,cACnB,YACAU,EACAJ,EACA,GACA,EACA,EACN,EAEI,KAAK,iBAAiB,YAAYN,CAAO,EACzC,KAAK,oBAAmB,EACxB,KAAK,eAAc,CACpB,CAaD,cACEY,EACAP,EACAC,EAAW,KACXO,EAAU,GACVC,EACAC,EAAa,GACb,CACA,MAAMf,EAAU,SAAS,cAAc,mBAAmB,EAC1D,OAAAA,EAAQ,SAAW,KAAK,SACxBA,EAAQ,aAAa,SAAUY,CAAM,EACrCZ,EAAQ,aAAa,UAAWK,CAAO,EAEnCU,GACFf,EAAQ,aAAa,YAAa,EAAE,EAGlCM,GACFN,EAAQ,aAAa,WAAY,KAAK,UAAUM,CAAQ,CAAC,EAItDO,GACHb,EAAQ,aAAa,eAAgB,OAAO,EAG1Cc,GACFd,EAAQ,aAAa,uBAAwBc,EAAe,SAAU,CAAA,EAGjEd,CACR,CAQD,WAAWO,EAASS,EAAc,GAAO,CACvC,GAAI,CAAC,MAAM,QAAQT,CAAO,EAAG,CAC3B,QAAQ,MAAM,wBAAyBA,CAAO,EAC9C,MACD,CAGD,MAAMU,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,UAAY,eAExBV,EAAQ,QAASW,GAAe,CAC9B,MAAMC,EAAS,SAAS,cAAc,kBAAkB,EACxDA,EAAO,SAAW,KAAK,SACvBA,EAAO,aAAa,QAASD,EAAW,IAAI,EAC5CC,EAAO,aAAa,UAAW,KAAK,UAAUD,EAAW,OAAO,CAAC,EACjED,EAAY,YAAYE,CAAM,CACpC,CAAK,EAED,KAAK,iBAAiB,YAAYF,CAAW,EAC7C,KAAK,eAAc,CACpB,CAQD,YAAYT,EAAOQ,EAAc,GAAO,CACtC,GAAI,CAAC,MAAM,QAAQR,CAAK,EAAG,CACzB,QAAQ,MAAM,0BAA2BA,CAAK,EAC9C,MACD,CAGD,MAAMY,EAAW,SAAS,cAAc,oBAAoB,EAC5DA,EAAS,SAAW,KAAK,SACzBA,EAAS,aAAa,gBAAiB,KAAK,UAAU,CAAE,MAAOZ,CAAO,CAAA,CAAC,EACvE,KAAK,iBAAiB,YAAYY,CAAQ,EAC1C,KAAK,eAAc,CACpB,CAMD,oBAAoBpB,EAAU,wBAAyB,CACjD,KAAK,kBACP,KAAK,gBAAgB,MAAM,QAAU,OAGjCA,GAAW,KAAK,aAClB,KAAK,WAAW,YAAcA,GAGhC,KAAK,eAAc,EAEtB,CAMD,qBAAsB,CAChB,KAAK,kBACP,KAAK,gBAAgB,MAAM,QAAU,OAExC,CAOD,aAAaA,EAAS,CAEpB,MAAMqB,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,UAAU,IAAI,eAAe,EACtCA,EAAS,YAAcrB,EACvB,KAAK,iBAAiB,YAAYqB,CAAQ,EAC1C,KAAK,eAAc,CACpB,CAMD,2BAA4B,CAET,KAAK,iBAAiB,iBACrC,qDACN,EACa,QAASC,GAAYA,EAAQ,OAAQ,CAAA,CAC/C,CAMD,gBAAiB,SACf,GAAI,KAAK,OAAS,OAAQ,CAExB,MAAMC,GAAaC,GAAA1B,EAAA,KAAK,UACrB,QAAQ,eAAe,IADP,YAAAA,EAEf,aAFe,YAAA0B,EAEH,cAAc,iBAC1BD,IACFA,EAAW,UAAYA,EAAW,aAE1C,MAEM,KAAK,aAAa,UAAY,KAAK,aAAa,YAEnD,CAMD,SAAU,CACJ,KAAK,iBACP,KAAK,gBAAgB,QAEvB,KAAK,SAAS,oBACf,CAWD,WACEX,EACAZ,EACAM,EAAW,KACXU,EAAc,GACdD,EAAa,GACb,CACA,MAAMU,EACJb,IAAW,aAAe,CAACG,EAAaJ,EAAcX,CAAO,EAAIA,EAE7D0B,EAAgBd,IAAW,aAAe,CAACI,EAC3CF,EAAiBE,EAAc,EAAI,OAEnCW,EAAmB,KAAK,cAC5Bf,EACAa,EACAnB,EACAoB,EACAZ,EACAC,CACN,EAEI,KAAK,iBAAiB,YAAYY,CAAgB,EAClD,KAAK,eAAc,CACpB,CAED,iBAAiBlB,EAAS,CACxB,MAAMmB,EAAmB,SAAS,cAAc,KAAK,EACrDA,EAAiB,UAAY,iBAE7B,MAAMC,EAAQ,SAAS,cAAc,IAAI,EACzCA,EAAM,UAAY,wBAClBA,EAAM,YAAc,oBACpBD,EAAiB,YAAYC,CAAK,EAElCpB,EAAQ,QAASqB,GAAS,CACxB,MAAMC,EAAgB,SAAS,cAAc,KAAK,EAClDA,EAAc,UAAY,0BAE1B,MAAMC,EAAa,SAAS,cAAc,KAAK,EAC/CA,EAAW,UAAY,yBACvBA,EAAW,YACTF,EAAK,KAAK,OAAO,CAAC,EAAE,cAAgBA,EAAK,KAAK,MAAM,CAAC,EACvDC,EAAc,YAAYC,CAAU,EAEpC,MAAMC,EAAiB,SAAS,cAAc,IAAI,EAClDA,EAAe,UAAY,uBAE3BH,EAAK,QAAQ,QAASI,GAAQ,CAC5B,MAAMC,EAAU,SAAS,cAAc,IAAI,EACrCC,EAAU,SAAS,cAAc,GAAG,EAC1CA,EAAQ,KAAOF,EACfE,EAAQ,OAAS,SACjBA,EAAQ,IAAM,sBACdA,EAAQ,YAAc,IAAI,IAAIF,CAAG,EAAE,SACnCC,EAAQ,YAAYC,CAAO,EAC3BH,EAAe,YAAYE,CAAO,CAC1C,CAAO,EAEDJ,EAAc,YAAYE,CAAc,EACxCL,EAAiB,YAAYG,CAAa,CAChD,CAAK,EAED,KAAK,iBAAiB,YAAYH,CAAgB,EAClD,KAAK,eAAc,CACpB,CACH"}