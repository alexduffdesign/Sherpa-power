{"version":3,"file":"chatbot-section.BFVLB1pa.js","sources":["../frontend/sectionChatbot/chatbot-section.js"],"sourcesContent":["// /assets/scripts/chatbot/section/section-chatbot.js\n\nimport { BaseChatbot } from \"../baseChatbot/base-chatbot.js\";\nimport { SectionChatbotUI } from \"./chatbot-section-ui.js\";\nimport { generateUserId } from \"../utils/user-id-generator.js\";\n\n/**\n * SectionChatbot Web Component\n * Extends BaseChatbot with specific logic for the Section Chatbot\n * Handles product context, device answers, and focused interactions\n * @extends BaseChatbot\n */\nexport class SectionChatbot extends BaseChatbot {\n  constructor() {\n    super();\n    this.productDetails = {};\n  }\n\n  /**\n   * Initialize the chatbot UI\n   * @protected\n   * @override\n   */\n  initializeUI() {\n    this.ui = new SectionChatbotUI(this.shadowRoot, this.eventBus);\n    this.setupSectionChatbotEventListeners();\n  }\n\n  /**\n   * Initialize product details from element attributes\n   * @private\n   */\n  initializeProductDetails() {\n    this.productDetails = {\n      title: this.getAttribute(\"product-title\"),\n      capacity: this.getAttribute(\"product-capacity\"),\n      ac_output_continuous_power: this.getAttribute(\n        \"product-ac_output_continuous_power\"\n      ),\n      ac_output_peak_power: this.getAttribute(\"product-ac_output_peak_power\"),\n      dc_output_power: this.getAttribute(\"product-dc_output_power\"),\n    };\n    this.validateProductDetails();\n  }\n\n  /**\n   * Override initialize to add product context initialization\n   * @protected\n   * @override\n   */\n  initialize() {\n    this.initializeProductDetails();\n    super.initialize();\n  }\n\n  /**\n   * Validate required product details\n   * @private\n   */\n  validateProductDetails() {\n    const requiredFields = [\"title\", \"capacity\"];\n    const missingFields = requiredFields.filter(\n      (field) => !this.productDetails[field]\n    );\n\n    if (missingFields.length > 0) {\n      console.error(\n        `Missing required product details: ${missingFields.join(\", \")}`\n      );\n      this.eventBus.emit(\"error\", {\n        message:\n          \"Some product information is missing. Chat functionality may be limited.\",\n      });\n    }\n  }\n\n  /**\n   * Set up section-specific event listeners\n   * @private\n   */\n  setupSectionChatbotEventListeners() {\n    // Handle device_answer traces\n    this.eventBus.on(\"trace\", ({ type, payload }) => {\n      if (type === \"device_answer\") {\n        this.handleDeviceAnswer(payload);\n      }\n    });\n\n    // Handle input focus for launching\n    this.shadowRoot\n      .querySelector(\".chat-input\")\n      ?.addEventListener(\"focus\", () => {\n        if (!this.isLaunched) {\n          this.launch();\n        }\n      });\n  }\n\n  /**\n   * Handle device_answer traces by updating the applications grid\n   * @private\n   * @param {Object} payload - The device_answer payload\n   */\n  handleDeviceAnswer(payload) {\n    if (payload.applications) {\n      this.eventBus.emit(\"deviceAnswer\", {\n        applications: payload.applications,\n      });\n    }\n  }\n\n  /**\n   * Get product-specific launch payload\n   * @private\n   * @returns {Object} Launch payload with product details\n   */\n  getProductLaunchPayload() {\n    return {\n      action: {\n        type: \"launch\",\n        payload: {\n          context: {\n            startBlock: \"shopifySection\",\n            powerStationDetails: this.productDetails,\n          },\n        },\n      },\n    };\n  }\n\n  /**\n   * Override launch to include product details\n   * @public\n   * @override\n   */\n  launch() {\n    this.sendLaunch(this.getProductLaunchPayload());\n  }\n}\n\n// Register the web component\ncustomElements.define(\"section-chatbot\", SectionChatbot);\n"],"names":["SectionChatbot","BaseChatbot","SectionChatbotUI","missingFields","field","type","payload","_a"],"mappings":"uKAYO,MAAMA,UAAuBC,CAAY,CAC9C,aAAc,CACZ,QACA,KAAK,eAAiB,EACvB,CAOD,cAAe,CACb,KAAK,GAAK,IAAIC,EAAiB,KAAK,WAAY,KAAK,QAAQ,EAC7D,KAAK,kCAAiC,CACvC,CAMD,0BAA2B,CACzB,KAAK,eAAiB,CACpB,MAAO,KAAK,aAAa,eAAe,EACxC,SAAU,KAAK,aAAa,kBAAkB,EAC9C,2BAA4B,KAAK,aAC/B,oCACD,EACD,qBAAsB,KAAK,aAAa,8BAA8B,EACtE,gBAAiB,KAAK,aAAa,yBAAyB,CAClE,EACI,KAAK,uBAAsB,CAC5B,CAOD,YAAa,CACX,KAAK,yBAAwB,EAC7B,MAAM,WAAU,CACjB,CAMD,wBAAyB,CAEvB,MAAMC,EADiB,CAAC,QAAS,UAAU,EACN,OAClCC,GAAU,CAAC,KAAK,eAAeA,CAAK,CAC3C,EAEQD,EAAc,OAAS,IACzB,QAAQ,MACN,qCAAqCA,EAAc,KAAK,IAAI,CAAC,EACrE,EACM,KAAK,SAAS,KAAK,QAAS,CAC1B,QACE,yEACV,CAAO,EAEJ,CAMD,mCAAoC,OAElC,KAAK,SAAS,GAAG,QAAS,CAAC,CAAE,KAAAE,EAAM,QAAAC,KAAc,CAC3CD,IAAS,iBACX,KAAK,mBAAmBC,CAAO,CAEvC,CAAK,GAGDC,EAAA,KAAK,WACF,cAAc,aAAa,IAD9B,MAAAA,EAEI,iBAAiB,QAAS,IAAM,CAC3B,KAAK,YACR,KAAK,OAAM,CAErB,EACG,CAOD,mBAAmBD,EAAS,CACtBA,EAAQ,cACV,KAAK,SAAS,KAAK,eAAgB,CACjC,aAAcA,EAAQ,YAC9B,CAAO,CAEJ,CAOD,yBAA0B,CACxB,MAAO,CACL,OAAQ,CACN,KAAM,SACN,QAAS,CACP,QAAS,CACP,WAAY,iBACZ,oBAAqB,KAAK,cAC3B,CACF,CACF,CACP,CACG,CAOD,QAAS,CACP,KAAK,WAAW,KAAK,wBAAyB,CAAA,CAC/C,CACH,CAGA,eAAe,OAAO,kBAAmBN,CAAc"}